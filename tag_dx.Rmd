---
title: "tag dx"
author: "clare f mccann"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    df_print: paged
    highlight: tango
    theme: united
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = FALSE, fig.path = "figs/", dpi = 300)

options(scipen=999)
```

# load packages
```{r}
library(pacman)
pacman::p_load(tidyverse, purrr, fs, reactable, ggplot2, install = TRUE)
```

# define aesthetics
```{r}
palette = c("#ffb800", "#e64626", "#00a896", "#165f8d", "#AE2012")

plot_aes = theme_minimal() +
  theme(legend.position = "top",
        legend.text = element_text(size = 8),
        text = element_text(size = 10, family = "Futura Medium"),
        axis.text = element_text(color = "black"),
        axis.line = element_line(colour = "black"),
        axis.ticks.y = element_blank())
```

## Set root path for Clare (laptop)
```{r}
root_path="/Users/clare/Desktop/projects/tag_dx/working_docs/"
```

## Set root path for work computer 
```{r}
root_path="~/Desktop/Projects/dx/working_docs/"
```

```{r Load data sets}
##pulling CSV files & calculating cronbach alpha
dx_full<-read.csv(paste0(root_path,"Lifetime_Diagnoses.csv"),
                  stringsAsFactors = FALSE) 

dx_names<-read.csv(paste0(root_path,"dx_names.csv"),
                  stringsAsFactors = FALSE)

dshi <-read.csv(paste0(root_path,"DSHI_All_Waves.csv"),
                  stringsAsFactors = FALSE) 

w1_count_output <- read.csv(paste0(root_path,"w1_dx_counts.csv"),
                  stringsAsFactors = FALSE)
w2_count_output <- read.csv(paste0(root_path,"w2_dx_counts.csv"),
                  stringsAsFactors = FALSE)
w3_count_output <- read.csv(paste0(root_path,"w3_dx_counts.csv"),
                  stringsAsFactors = FALSE)
w4_count_output <- read.csv(paste0(root_path,"w4_dx_counts.csv"),
                  stringsAsFactors = FALSE)
```

## Optional: checking for new dx names
```{r new diagnoses??}

## in working docs, paste the dx column from "Lifetime Dx Data.csv" into "Dx Names"

## creating doc to get each individual acronym used 
dx_names <- unique(dx_names)

## exporting doc to see if there are any new mutations to add below 
write.csv(dx_names, "dx_names.csv")

```

## Cleaning Dx Data
```{r cleaning}
## (anxiety = 1, mood = 2, disordered eating = 3) as of 09/08/2021

dx_full$dx_type <- dx_full$dx

dx_full <- dx_full %>%
  mutate(dx_type=ifelse(dx_type=="MDD", 2,
                          ifelse(dx_type=="SocP", 1,
                                 ifelse(dx_type=="ADDM", 2,
                                        ifelse(dx_type=="SimP", 1,
                                               ifelse(dx_type=="ENU", 1,
                                                      ifelse(dx_type=="GAD", 1,
                                                             ifelse(dx_type=="OCD", 1,
                                                                    ifelse(dx_type=="DNOS", 2,
                                                                           ifelse(dx_type=="PTSD", 1,
                                                                                  ifelse(dx_type=="AG", 1,
                                                                                         ifelse(dx_type=="PD", 1,
                                                                                                ifelse(dx_type=="AN", 3,
                                                                                                       ifelse(dx_type=="EDNOS", 3,
                                                                                                                     ifelse(dx_type=="BU", 3,
                                                                                                                            ifelse(dx_type=="ANOS", 1, 
                                                                                                                                          ifelse(dx_type=="BP2", 2,
                                                                                                                                                        ifelse(dx_type=="BP1", 2,
                                                                                                                                                                      ifelse(dx_type=="ADA", 1,
                                                                                                                                                                             ifelse(dx_type=="ASD", 1,                                                                                      ifelse(dx_type=="Schizo_Affect_Dep", 2,
                                                                                                                                                                                                  ifelse(dx_type=="DYS", 2,
                                                                                                                                                                                                         ifelse(dx_type=="ManEp", 2,
                                                                                                                                                                                                                ifelse(dx_type=="HypoEp", 2,
                                                                                                                                                                                                                       ifelse(dx_type=="PD_AG", 1,
                                                                                                                                                                                                                                     ifelse(dx_type=="SepAnx", 1,
                                                                                                                                                                                                                                            ifelse(dx_type=="MDD_B", 2,
                                                                                                                                                                                                                                                          ifelse(dx_type=="MixedEp_Psychotic", 2, 
                                                                                                                                                                                                                                                                 ifelse(dx_type=="Schizo_Affect_Bi", 2,
                                                                                                                                                                                                                                                                        ifelse(dx_type=="ADADM", 4,
                                                                                                                                                                                                                                                                 dx_type))))))))))))))))))))))))))))))

## creating wave docs 

## W1 

w1_dx_current <-  dx_full[which(dx_full$W1_current=="1"),]
w1_dx_past <- dx_full[which(dx_full$W1_past=="1"),]
w1_dx <- full_join(w1_dx_current, w1_dx_past)

## W2

w2_dx_current <-  dx_full[which(dx_full$W2_current=="1"),]
w2_dx_past <- dx_full[which(dx_full$W2_past=="1"),]
w2_dx <- full_join(w2_dx_current, w2_dx_past)
                                                                    
## W3

w3_dx_current <-  dx_full[which(dx_full$W3_current=="1"),]
w3_dx_past <- dx_full[which(dx_full$W3_past=="1"),]
w3_dx <- full_join(w3_dx_current, w3_dx_past)

## W4

w4_dx_current <-  dx_full[which(dx_full$W4_current=="1"),]
w4_dx_past <- dx_full[which(dx_full$W4_past=="1"),]
w4_dx <- full_join(w4_dx_current, w4_dx_past)
         
```
## Question 1: How many participants met for any anxiety/mood/ed disorder in each wave?
```{r 1}

## How many participants met for any anxiety/mood/ed disorder in each wave?

## W1 

w1_dx_anxiety <-  w1_dx[which(w1_dx$dx_type=="1"),]
w1_dx_mood <- w1_dx[which(w1_dx$dx_type=="2"),]
w1_dx_ed <- w1_dx[which(w1_dx$dx_type=="3"),]

w1_dx_anxiety <- w1_dx_anxiety[!duplicated(w1_dx_anxiety$ID), ] ## 35 PARTICIPANTS 
w1_dx_mood <- w1_dx_mood[!duplicated(w1_dx_mood$ID), ] ## 12 PARTICIPANTS 
w1_dx_ed <- w1_dx_ed[!duplicated(w1_dx_ed$ID), ] ## 0 PARTICIPANTS 

w1_dx_anxiety <- w1_dx_anxiety %>%
  count(w1_dx_anxiety$ID)
w1_dx_mood <- w1_dx_mood %>%
  count(w1_dx_mood$ID)
w1_dx_ed <- w1_dx_ed %>%
  count(w1_dx_ed$ID)

## W2 

w2_dx_anxiety <-  w2_dx[which(w2_dx$dx_type=="1"),]
w2_dx_mood <- w2_dx[which(w2_dx$dx_type=="2"),]
w2_dx_ed <- w2_dx[which(w2_dx$dx_type=="3"),]

w2_dx_anxiety <- w2_dx_anxiety[!duplicated(w2_dx_anxiety$ID), ]  ## 43 PARTICIPANTS
w2_dx_mood <- w2_dx_mood[!duplicated(w2_dx_mood$ID), ]  ## 31 PARTICIPANTS 
w2_dx_ed <- w2_dx_ed[!duplicated(w2_dx_ed$ID), ] ## 2 PARTICIPANTS 

w2_dx_anxiety <- w2_dx_anxiety %>%
  count(w2_dx_anxiety$ID)
w2_dx_mood <- w2_dx_mood %>%
  count(w2_dx_mood$ID)
w2_dx_ed <- w2_dx_ed %>%
  count(w2_dx_ed$ID)


## W3 

w3_dx_anxiety <-  w3_dx[which(w3_dx$dx_type=="1"),]
w3_dx_mood <- w3_dx[which(w3_dx$dx_type=="2"),]
w3_dx_ed <- w3_dx[which(w3_dx$dx_type=="3"),]

w3_dx_anxiety <- w3_dx_anxiety[!duplicated(w3_dx_anxiety$ID), ]  ## 42 PARTICIPANTS
w3_dx_mood <- w3_dx_mood[!duplicated(w3_dx_mood$ID), ]  ## 39 PARTICIPANTS 
w3_dx_ed <- w3_dx_ed[!duplicated(w3_dx_ed$ID), ] ## 10 PARTICIPANTS

w3_dx_anxiety <- w3_dx_anxiety %>%
  count(w3_dx_anxiety$ID)
w3_dx_mood <- w3_dx_mood %>%
  count(w3_dx_mood$ID)
w3_dx_ed <- w3_dx_ed %>%
  count(w3_dx_ed$ID)

## w4 

w4_dx_anxiety <-  w4_dx[which(w4_dx$dx_type=="1"),]
w4_dx_mood <- w4_dx[which(w4_dx$dx_type=="2"),]
w4_dx_ed <- w4_dx[which(w4_dx$dx_type=="3"),]
w4_dx_co <- w4_dx[which(w4_dx$dx_type=="4"),]

w4_dx_anxiety <- w4_dx_anxiety[!duplicated(w4_dx_anxiety$ID), ]  ## 13 PARTICIPANTS
w4_dx_mood <- w4_dx_mood[!duplicated(w4_dx_mood$ID), ]  ## 7 PARTICIPANTS 
w4_dx_ed <- w4_dx_ed[!duplicated(w4_dx_ed$ID), ] ## 1 PARTICIPANT

w4_dx_anxiety <- w4_dx_anxiety %>%
  count(w4_dx_anxiety$ID)
w4_dx_mood <- w4_dx_mood %>%
  count(w4_dx_mood$ID)
w4_dx_ed <- w4_dx_ed %>%
  count(w4_dx_ed$ID)



```

#3 Question 2: How many participants are currently experiencing anxiety/mood/disordered eating?
```{r 2}
## How many participants are currently experiencing anxiety/mood/disordered eating? 

## W1 

# number of current diagnoses 

w1_dx_anxiety_current_full <-  w1_dx_current[which(w1_dx_current$dx_type=="1"),]
w1_dx_mood_current_full <- w1_dx_current[which(w1_dx_current$dx_type=="2"),]
w1_dx_ed_current_full <- w1_dx_current[which(w1_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w1_dx_anxiety_current <- w1_dx_anxiety_current_full[!duplicated(w1_dx_anxiety_current_full$ID), ] ## 24 PARTICIPANTS
w1_dx_mood_current <- w1_dx_mood_current_full[!duplicated(w1_dx_mood_current_full$ID), ] ## 5 PARTICIPANTS 
w1_dx_ed_current <- w1_dx_ed_current_full[!duplicated(w1_dx_ed_current_full$ID), ] ## 0 PARTICIPANTS

w1_dx_anxiety_current <- w1_dx_anxiety_current %>%
  count(w1_dx_anxiety_current$ID)
w1_dx_mood_current <- w1_dx_mood_current %>%
  count(w1_dx_mood_current$ID)
w1_dx_ed_current <- w1_dx_ed_current %>%
  count(w1_dx_ed_current$ID)

## W2

# number of current diagnoses 

w2_dx_anxiety_current_full <-  w2_dx_current[which(w2_dx_current$dx_type=="1"),]
w2_dx_mood_current_full <- w2_dx_current[which(w2_dx_current$dx_type=="2"),]
w2_dx_ed_current_full <- w2_dx_current[which(w2_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w2_dx_anxiety_current <- w2_dx_anxiety_current_full[!duplicated(w2_dx_anxiety_current_full$ID), ] ## 38 PARTICIPANTS
w2_dx_mood_current <- w2_dx_mood_current_full[!duplicated(w2_dx_mood_current_full$ID), ] ## 15 PARTICIPANTS 
w2_dx_ed_current <- w2_dx_ed_current_full[!duplicated(w2_dx_ed_current_full$ID), ] ## 0 PARTICIPANTS

w2_dx_anxiety_current <- w2_dx_anxiety_current %>%
  count(w2_dx_anxiety_current$ID)
w2_dx_mood_current <- w2_dx_mood_current %>%
  count(w2_dx_mood_current$ID)
w2_dx_ed_current <- w2_dx_ed_current %>%
  count(w2_dx_ed_current$ID)

## W3

# number of current diagnoses 

w3_dx_anxiety_current_full <-  w3_dx_current[which(w3_dx_current$dx_type=="1"),]
w3_dx_mood_current_full <- w3_dx_current[which(w3_dx_current$dx_type=="2"),]
w3_dx_ed_current_full <- w3_dx_current[which(w3_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w3_dx_anxiety_current <- w3_dx_anxiety_current_full[!duplicated(w3_dx_anxiety_current_full$ID), ] ## 37 PARTICIPANTS
w3_dx_mood_current <- w3_dx_mood_current_full[!duplicated(w3_dx_mood_current_full$ID), ] ## 18 PARTICIPANTS 
w3_dx_ed_current <- w3_dx_ed_current_full[!duplicated(w3_dx_ed_current_full$ID), ] ## 4 PARTICIPANTS

w3_dx_anxiety_current <- w3_dx_anxiety_current %>%
  count(w3_dx_anxiety_current$ID)
w3_dx_mood_current <- w3_dx_mood_current %>%
  count(w3_dx_mood_current$ID)
w3_dx_ed_current <- w3_dx_ed_current %>%
  count(w3_dx_ed_current$ID)

## W4

# number of current diagnoses 

w4_dx_anxiety_current_full <-  w4_dx_current[which(w4_dx_current$dx_type=="1"),]
w4_dx_mood_current_full <- w4_dx_current[which(w4_dx_current$dx_type=="2"),]
w4_dx_ed_current_full <- w4_dx_current[which(w4_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w4_dx_anxiety_current <- w4_dx_anxiety_current_full[!duplicated(w4_dx_anxiety_current_full$ID), ] ## 12 PARTICIPANTS
w4_dx_mood_current <- w4_dx_mood_current_full[!duplicated(w4_dx_mood_current_full$ID), ] ## 3 PARTICIPANTS 
w4_dx_ed_current <- w4_dx_ed_current_full[!duplicated(w4_dx_ed_current_full$ID), ] ## 0 PARTICIPANTS

w4_dx_anxiety_current <- w4_dx_anxiety_current %>%
  count(w4_dx_anxiety_current$ID)
w4_dx_mood_current <- w4_dx_mood_current %>%
  count(w4_dx_mood_current$ID)
w4_dx_ed_current <- w4_dx_ed_current %>%
  count(w4_dx_ed_current$ID)

```

## Question 3: How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed currently?
```{r 3}
## How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed currently?

## W1 

w1_comorbid_current_ma <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_anxiety_current$ID,]
w1_comorbid_current_ma <- w1_comorbid_current_ma[!duplicated(w1_comorbid_current_ma$ID), ] ## 3
w1_comorbid_current_ae <- w1_dx_anxiety_current[w1_dx_anxiety_current$ID %in% w1_dx_ed_current$ID,]
w1_comorbid_current_ae <- w1_comorbid_current_ae[!duplicated(w1_comorbid_current_ae$ID), ] ## 0 
w1_comorbid_current_me <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_ed_current$ID,]
w1_comorbid_current_me <- w1_comorbid_current_me[!duplicated(w1_comorbid_current_me$ID), ] ## 0
w1_comorbid_current <- full_join(w1_comorbid_current_ae, w1_comorbid_current_ma)
w1_comorbid_current <- full_join(w1_comorbid_current, w1_comorbid_current_me)
w1_comorbid_current <- w1_comorbid_current[!duplicated(w1_comorbid_current$ID), ] ## 3 TOTAL

w1_comorbid_current <- w1_comorbid_current%>%
  count(w1_comorbid_current$ID)

# W2 

w2_comorbid_current_ma <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_anxiety_current$ID,]
w2_comorbid_current_ma <- w2_comorbid_current_ma[!duplicated(w2_comorbid_current_ma$ID), ] ## 7
w2_comorbid_current_ae <- w2_dx_anxiety_current[w2_dx_anxiety_current$ID %in% w2_dx_ed_current$ID,]
w2_comorbid_current_ae <- w2_comorbid_current_ae[!duplicated(w2_comorbid_current_ae$ID), ]## 0 
w2_comorbid_current_me <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_ed_current$ID,] ## 0 
w2_comorbid_current_me <- w2_comorbid_current_me[!duplicated(w2_comorbid_current_me$ID), ]
w2_comorbid_current <- full_join(w2_comorbid_current_ae, w2_comorbid_current_ma)
w2_comorbid_current <- full_join(w2_comorbid_current, w2_comorbid_current_me) 
w2_comorbid_current <- w2_comorbid_current[!duplicated(w2_comorbid_current$ID), ] ## 7 TOTAL

w2_comorbid_current <- w2_comorbid_current%>%
  count(w2_comorbid_current$ID)

## W3 

w3_comorbid_current_ma <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_anxiety_current$ID,] 
w3_comorbid_current_ma <- w3_comorbid_current_ma[!duplicated(w3_comorbid_current_ma$ID), ]
w3_comorbid_current_ae <- w3_dx_anxiety_current[w3_dx_anxiety_current$ID %in% w3_dx_ed_current$ID,]
w3_comorbid_current_ae <- w3_comorbid_current_ae[!duplicated(w3_comorbid_current_ae$ID), ]
w3_comorbid_current_me <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_ed_current$ID,] 
w3_comorbid_current_me <- w3_comorbid_current_me[!duplicated(w3_comorbid_current_me$ID), ]
w3_comorbid_current <- full_join(w3_comorbid_current_ae, w3_comorbid_current_ma)
w3_comorbid_current <- full_join(w3_comorbid_current, w3_comorbid_current_me)
w3_comorbid_current <- w3_comorbid_current[!duplicated(w3_comorbid_current$ID), ] ## 18 TOTAL

w3_comorbid_current <- w3_comorbid_current%>%
  count(w3_comorbid_current$ID)

## W4

w4_comorbid_current_ma <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_anxiety_current$ID,]
w4_comorbid_current_ma <- w4_comorbid_current_ma[!duplicated(w4_comorbid_current_ma$ID), ] ## 1 
w4_comorbid_current_ae <- w4_dx_anxiety_current[w4_dx_anxiety_current$ID %in% w4_dx_ed_current$ID,]
w4_comorbid_current_ae <- w4_comorbid_current_ae[!duplicated(w4_comorbid_current_ae$ID), ]## 0  
w4_comorbid_current_me <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_ed_current$ID,]
w4_comorbid_current_me <- w4_comorbid_current_me[!duplicated(w4_comorbid_current_me$ID), ]## 0 
w4_comorbid_current <- full_join(w4_comorbid_current_ae, w4_comorbid_current_ma)
w4_comorbid_current <- full_join(w4_comorbid_current, w4_comorbid_current_me) ## 1 TOTAL
w4_comorbid_current <- w4_comorbid_current[!duplicated(w4_comorbid_current$ID), ] 

w4_comorbid_current <- w4_comorbid_current%>%
  count(w4_comorbid_current$ID)
```

## Question 4: How many participants have experienced anxiety/mood/disordered eating in the past two years? 
```{r 4}
## How many participants have experienced anxiety/mood/disordered eating in the past two years? 

## W1 

# number of past diagnoses 

w1_dx_anxiety_past_full <-  w1_dx_past[which(w1_dx_past$dx_type=="1"),]
w1_dx_mood_past_full <- w1_dx_past[which(w1_dx_past$dx_type=="2"),]
w1_dx_ed_past_full <- w1_dx_past[which(w1_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w1_dx_anxiety_past <- w1_dx_anxiety_past_full[!duplicated(w1_dx_anxiety_past_full$ID), ] ## 15 PARTICIPANTS
w1_dx_mood_past <- w1_dx_mood_past_full[!duplicated(w1_dx_mood_past_full$ID), ] ## 8 PARTICIPANTS 
w1_dx_ed_past <- w1_dx_ed_past_full[!duplicated(w1_dx_ed_past_full$ID), ] ## 0 PARTICIPANTS

w1_dx_anxiety_past <- w1_dx_anxiety_past %>%
  count(w1_dx_anxiety_past$ID)
w1_dx_mood_past <- w1_dx_mood_past %>%
  count(w1_dx_mood_past$ID)
w1_dx_ed_past <- w1_dx_ed_past %>%
  count(w1_dx_ed_past$ID)

## W2

# number of past diagnoses 

w2_dx_anxiety_past_full <-  w2_dx_past[which(w2_dx_past$dx_type=="1"),]
w2_dx_mood_past_full <- w2_dx_past[which(w2_dx_past$dx_type=="2"),]
w2_dx_ed_past_full <- w2_dx_past[which(w2_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w2_dx_anxiety_past <- w2_dx_anxiety_past_full[!duplicated(w2_dx_anxiety_past_full$ID), ] ## 11 PARTICIPANTS
w2_dx_mood_past <- w2_dx_mood_past_full[!duplicated(w2_dx_mood_past_full$ID), ] ## 22 PARTICIPANTS 
w2_dx_ed_past <- w2_dx_ed_past_full[!duplicated(w2_dx_ed_past_full$ID), ] ## 2 PARTICIPANTS

w2_dx_anxiety_past <- w2_dx_anxiety_past %>%
  count(w2_dx_anxiety_past$ID)
w2_dx_mood_past <- w2_dx_mood_past %>%
  count(w2_dx_mood_past$ID)
w2_dx_ed_past <- w2_dx_ed_past %>%
  count(w2_dx_ed_past$ID)

## W3

# number of past diagnoses 

w3_dx_anxiety_past_full <-  w3_dx_past[which(w3_dx_past$dx_type=="1"),]
w3_dx_mood_past_full <- w3_dx_past[which(w3_dx_past$dx_type=="2"),]
w3_dx_ed_past_full <- w3_dx_past[which(w3_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w3_dx_anxiety_past <- w3_dx_anxiety_past_full[!duplicated(w3_dx_anxiety_past_full$ID), ] ## 11 PARTICIPANTS
w3_dx_mood_past <- w3_dx_mood_past_full[!duplicated(w3_dx_mood_past_full$ID), ] ## 27 PARTICIPANTS 
w3_dx_ed_past <- w3_dx_ed_past_full[!duplicated(w3_dx_ed_past_full$ID), ] ## 7 PARTICIPANTS

w3_dx_anxiety_past <- w3_dx_anxiety_past %>%
  count(w3_dx_anxiety_past$ID)
w3_dx_mood_past <- w3_dx_mood_past %>%
  count(w3_dx_mood_past$ID)
w3_dx_ed_past <- w3_dx_ed_past %>%
  count(w3_dx_ed_past$ID)

## W4 

# number of past diagnoses 

w4_dx_anxiety_past_full <-  w4_dx_past[which(w4_dx_past$dx_type=="1"),]
w4_dx_mood_past_full <- w4_dx_past[which(w4_dx_past$dx_type=="2"),]
w4_dx_ed_past_full <- w4_dx_past[which(w4_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w4_dx_anxiety_past <- w4_dx_anxiety_past_full[!duplicated(w4_dx_anxiety_past_full$ID), ] ## 1 PARTICIPANT
w4_dx_mood_past <- w4_dx_mood_past_full[!duplicated(w4_dx_mood_past_full$ID), ] ## 4 PARTICIPANTS 
w4_dx_ed_past <- w4_dx_ed_past_full[!duplicated(w4_dx_ed_past_full$ID), ] ## 1 PARTICIPANT

w4_dx_anxiety_past <- w4_dx_anxiety_past %>%
  count(w4_dx_anxiety_past$ID)
w4_dx_mood_past <- w4_dx_mood_past %>%
  count(w4_dx_mood_past$ID)
w4_dx_ed_past <- w4_dx_ed_past %>%
  count(w4_dx_ed_past$ID)
```

## Question 5: How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed past?
```{r 5}
## How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed past?

## W1 

w1_comorbid_past_ma <- w1_dx_mood_past[w1_dx_mood_past$ID %in% w1_dx_anxiety_past$ID,] 
w1_comorbid_past_ma <- w1_comorbid_past_ma[!duplicated(w1_comorbid_past_ma$ID), ] ## 1
w1_comorbid_past_ae <- w1_dx_anxiety_past[w1_dx_anxiety_past$ID %in% w1_dx_ed_past$ID,]
w1_comorbid_past_ae <- w1_comorbid_past_ae[!duplicated(w1_comorbid_past_ae$ID), ]## 0 
w1_comorbid_past_me <- w1_dx_mood_past[w1_dx_mood_past$ID %in% w1_dx_ed_past$ID,] 
w1_comorbid_past_me <- w1_comorbid_past_me[!duplicated(w1_comorbid_past_me$ID), ]## 0
w1_comorbid_past <- full_join(w1_comorbid_past_ae, w1_comorbid_past_ma)
w1_comorbid_past <- full_join(w1_comorbid_past, w1_comorbid_past_me)
w1_comorbid_past <- w1_comorbid_past[!duplicated(w1_comorbid_past$ID), ] ## 1 TOTAL

w1_comorbid_past <- w1_comorbid_past%>%
  count(w1_comorbid_past$ID)

# W2 

w2_comorbid_past_ma <- w2_dx_mood_past[w2_dx_mood_past$ID %in% w2_dx_anxiety_past$ID,] 
w2_comorbid_past_ma <- w2_comorbid_past_ma[!duplicated(w2_comorbid_past_ma$ID), ]## 7
w2_comorbid_past_ae <- w2_dx_anxiety_past[w2_dx_anxiety_past$ID %in% w2_dx_ed_past$ID,]
w2_comorbid_past_ae <- w2_comorbid_past_ae[!duplicated(w2_comorbid_past_ae$ID), ] ## 0 
w2_comorbid_past_me <- w2_dx_mood_past[w2_dx_mood_past$ID %in% w2_dx_ed_past$ID,] 
w2_comorbid_past_me <- w2_comorbid_past_me[!duplicated(w2_comorbid_past_me$ID), ] ## 2 
w2_comorbid_past <- full_join(w2_comorbid_past_ae, w2_comorbid_past_ma)
w2_comorbid_past <- full_join(w2_comorbid_past, w2_comorbid_past_me)
w2_comorbid_past <- w2_comorbid_past[!duplicated(w2_comorbid_past$ID), ] ## 9 TOTAL

w1_comorbid_past <- w1_comorbid_past%>%
  count(w1_comorbid_past$ID)

## W3 

w3_comorbid_past_ma <- w3_dx_mood_past[w3_dx_mood_past$ID %in% w3_dx_anxiety_past$ID,] 
w3_comorbid_past_ma <- w3_comorbid_past_ma[!duplicated(w3_comorbid_past_ma$ID), ]## 4
w3_comorbid_past_ae <- w3_dx_anxiety_past[w3_dx_anxiety_past$ID %in% w3_dx_ed_past$ID,] 
w3_comorbid_past_ae <- w3_comorbid_past_ae[!duplicated(w3_comorbid_past_ae$ID), ] ## 2
w3_comorbid_past_me <- w3_dx_mood_past[w3_dx_mood_past$ID %in% w3_dx_ed_past$ID,] 
w3_comorbid_past_me <- w3_comorbid_past_me[!duplicated(w3_comorbid_past_me$ID), ] ## 4
w3_comorbid_past <- full_join(w3_comorbid_past_ae, w3_comorbid_past_ma)
w3_comorbid_past <- full_join(w3_comorbid_past, w3_comorbid_past_me)
w3_comorbid_past <- w3_comorbid_past[!duplicated(w3_comorbid_past$ID), ] ## 8 TOTAL

w1_comorbid_past <- w1_comorbid_past%>%
  count(w1_comorbid_past$ID)

## W4

w4_comorbid_past_ma <- w4_dx_mood_past[w4_dx_mood_past$ID %in% w4_dx_anxiety_past$ID,]
w4_comorbid_past_ma <- w4_comorbid_past_ma[!duplicated(w4_comorbid_past_ma$ID), ]## 1
w4_comorbid_past_ae <- w4_dx_anxiety_past[w4_dx_anxiety_past$ID %in% w4_dx_ed_past$ID,] 
w4_comorbid_past_ae <- w4_comorbid_past_ae[!duplicated(w4_comorbid_past_ae$ID), ] ## 1
w4_comorbid_past_me <- w4_dx_mood_past[w4_dx_mood_past$ID %in% w4_dx_ed_past$ID,]
w4_comorbid_past_me <- w4_comorbid_past_me[!duplicated(w4_comorbid_past_me$ID), ] ## 1
w4_comorbid_past <- full_join(w4_comorbid_past_ae, w4_comorbid_past_ma) ## 1
w4_comorbid_past <- full_join(w4_comorbid_past, w4_comorbid_past_me)
w4_comorbid_past <- w4_comorbid_past[!duplicated(w4_comorbid_past$ID), ] ## 1 TOTAL

w1_comorbid_past <- w1_comorbid_past%>%
  count(w1_comorbid_past$ID)

```

## Question 6: How many participants met for at least one past and at least one current dx of the same classification in each wave?
```{r 6}
## How many participants met for at least one past and at least one current dx of the same classification in each wave? 

w1_anx_pc <- w1_dx_anxiety_current[w1_dx_anxiety_current$ID %in% w1_dx_anxiety_past$ID, ] ## 5 
w1_anx_pc <- w1_anx_pc%>%
  count(w1_anx_pc$ID)
w2_anx_pc <- w2_dx_anxiety_current[w2_dx_anxiety_current$ID %in% w2_dx_anxiety_past$ID, ] ## 6
w2_anx_pc <- w2_anx_pc%>%
  count(w2_anx_pc$ID)
w3_anx_pc <- w3_dx_anxiety_current[w3_dx_anxiety_current$ID %in% w3_dx_anxiety_past$ID, ] ## 6 
w3_anx_pc <- w3_anx_pc%>%
  count(w3_anx_pc$ID)
w4_anx_pc <- w4_dx_anxiety_current[w4_dx_anxiety_current$ID %in% w4_dx_anxiety_past$ID, ] ## 0
w4_anx_pc <- w4_anx_pc%>%
  count(w4_anx_pc$ID)

w1_mood_pc <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_mood_past$ID, ] ## 1 
w1_mood_pc <- w1_mood_pc%>%
  count(w1_mood_pc$ID)
w2_mood_pc <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_mood_past$ID, ] ## 6
w2_mood_pc <- w2_mood_pc%>%
  count(w2_mood_pc$ID)
w3_mood_pc <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_mood_past$ID, ] ## 6 
w3_mood_pc <- w3_mood_pc%>%
  count(w3_mood_pc$ID)
w4_mood_pc <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_mood_past$ID, ] ## 0 
w4_mood_pc <- w4_mood_pc%>%
  count(w4_mood_pc$ID)

w1_ed_pc <- w1_dx_ed_current[w1_dx_ed_current$ID %in% w1_dx_ed_past$ID, ] ## 0 
w1_ed_pc <- w1_ed_pc%>%
  count(w1_ed_pc$ID)
w2_ed_pc <- w2_dx_ed_current[w2_dx_ed_current$ID %in% w2_dx_ed_past$ID, ] ## 0
w2_ed_pc <- w2_ed_pc%>%
  count(w2_ed_pc$ID)
w3_ed_pc <- w3_dx_ed_current[w3_dx_ed_current$ID %in% w3_dx_ed_past$ID, ] ## 1
w3_ed_pc <- w3_ed_pc%>%
  count(w3_ed_pc$ID)
w4_ed_pc <- w4_dx_ed_current[w4_dx_ed_current$ID %in% w4_dx_ed_past$ID, ] ## 0 
w4_ed_pc <- w4_ed_pc%>%
  count(w4_ed_pc$ID)
```

## Question 7: How many participants met for something new at each wave?
```{r 7}
## How many participants met for something new at each wave? 

# new in W2 

w2_reoccuring_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w2_dx_anxiety$ID, ] ## 16 px had recurrences of anx in W2 (27 NEW) 
w2_reoccuring_anx<- w2_reoccuring_anx[!duplicated(w2_reoccuring_anx$ID), ]

w2_reoccuring_anx <- w2_reoccuring_anx%>%
  count(w2_reoccuring_anx$ID)


# new in W3

w1_w3_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w3_dx_anxiety$ID, ] # 10 px had recurrences of anx from W1 in W3 
w2_w3_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% w3_dx_anxiety$ID, ] # 16 px had recurrences of anx from W2 in W3
# total recurrences = 24, total new = 19
w3_reoccuring_anx <- full_join(w1_w3_anx, full_join(w1_w3_anx, w2_w3_anx))
w3_reoccuring_anx<- w3_reoccuring_anx[!duplicated(w3_reoccuring_anx$ID), ]

w3_reoccuring_anx <- w3_reoccuring_anx%>%
  count(w3_reoccuring_anx$ID)

# new in w4 

w1_w4_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w4_dx_anxiety$ID, ] ## 4 px had reoccurences 
w2_w4_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% w4_dx_anxiety$ID, ] ## 7 px had reoccurences 
w3_w4_anx <- w3_dx_anxiety[w3_dx_anxiety$ID %in% w4_dx_anxiety$ID, ] ## 5 px had reoccurences 
w4_reoccuring_anx <- full_join(w1_w4_anx, full_join(w2_w4_anx, w3_w4_anx))
w4_reoccuring_anx <- w4_reoccuring_anx[!duplicated(w4_reoccuring_anx$ID), ] ## 11 TOTAL 

w4_reoccuring_anx <- w4_reoccuring_anx%>%
  count(w4_reoccuring_anx$ID)


# new mood in W2 

w2_reoccuring_mood <- w1_dx_mood[w1_dx_mood$ID %in% w2_dx_mood$ID, ] ## 4 px had recurrences of mood in W2 (27 NEW) 
w2_reoccuring_mood <- w2_reoccuring_mood[!duplicated(w2_reoccuring_mood$ID), ] ## 4 total 

w2_reoccuring_mood <- w2_reoccuring_mood %>%
  count(w2_reoccuring_mood$ID)

# new in W3

w1_w3_mood <- w1_dx_mood[w1_dx_mood$ID %in% w3_dx_mood$ID, ] # 4 px had recurrences of mood from W1 in W3 
w2_w3_mood <- w2_dx_mood[w2_dx_mood$ID %in% w3_dx_mood$ID, ] 
w3_reoccuring_mood <- full_join(w1_w3_mood, full_join(w1_w3_mood, w2_w3_mood))
w3_reoccuring_mood <- w3_reoccuring_mood[!duplicated(w3_reoccuring_mood$ID), ] ## 15 TOTAL 

# total recurrences = 15, total new = 24

w3_reoccuring_mood <- w3_reoccuring_mood %>%
  count(w3_reoccuring_mood$ID)

# new mood in W4 

w1_w4_mood <- w1_dx_mood[w1_dx_mood$ID %in% w4_dx_mood$ID, ] ## 1 px had reoccurences 
w2_w4_mood <- w2_dx_mood[w2_dx_mood$ID %in% w4_dx_mood$ID, ] ## 3 px had reoccurences 
w3_w4_mood <- w3_dx_mood[w3_dx_mood$ID %in% w4_dx_mood$ID, ] ## 4 px had reoccurences 
w4_reoccuring_mood <- full_join(w1_w4_mood, full_join(w2_w4_mood, w3_w4_mood))
w4_reoccuring_mood <- w4_reoccuring_mood[!duplicated(w4_reoccuring_mood$ID), ] ## 5 TOTAL

w4_reoccuring_mood <- w4_reoccuring_mood %>%
  count(w4_reoccuring_mood$ID)

# new ED in W2 

w2_reoccuring_ed  <- w1_dx_ed[w1_dx_ed$ID %in% w2_dx_ed$ID, ] ## 0 px had recurrences of anx in W2 (2 NEW) 
w2_reoccuring_ed <- w2_reoccuring_ed[!duplicated(w2_reoccuring_ed$ID), ]

w2_reoccuring_ed <- w2_reoccuring_ed %>%
  count(w2_reoccuring_ed$ID)

# new ED in W3

w1_w3_ed <- w1_dx_ed[w1_dx_ed$ID %in% w3_dx_ed$ID, ] # 0 px had recurrences of anx from W1 in W3 
w2_w3_ed <- w2_dx_ed[w2_dx_ed$ID %in% w3_dx_ed$ID, ] # 0 px had recurrences of anx from W2 in W3
# total recurrences = 0, total new = 10
w3_reoccuring_ed<- full_join(w1_w3_ed, full_join(w1_w3_ed, w2_w3_ed))
w3_reoccuring_ed <- w3_reoccuring_ed[!duplicated(w3_reoccuring_ed$ID), ]

w3_reoccuring_ed <- w3_reoccuring_ed %>%
  count(w3_reoccuring_ed$ID)

# new ED in W4 

w1_w4_ed <- w1_dx_ed[w1_dx_ed$ID %in% w4_dx_ed$ID, ] ## 0 px had reoccurences 
w2_w4_ed <- w2_dx_ed[w2_dx_ed$ID %in% w4_dx_ed$ID, ] ## 0 px had reoccurences 
w3_w4_ed <- w3_dx_ed[w3_dx_ed$ID %in% w4_dx_ed$ID, ] ## 0 px had reoccurences 
w4_reoccuring_ed <- full_join(w1_w4_ed, full_join(w2_w4_ed, w3_w4_ed))
w4_reoccuring_ed <- w4_reoccuring_ed[!duplicated(w4_reoccuring_ed$ID), ] ## 0 TOTAL

w4_reoccuring_ed <- w4_reoccuring_ed %>%
  count(w4_reoccuring_ed$ID)

```

```{r output count}



w1_count <- data.frame(Total_Anx = sum(w1_dx_anxiety$n),
                       Total_Mood = sum(w1_dx_mood$n),
                       Total_ED = sum(w1_dx_ed$n),
                       Current_Anx = sum(w1_dx_anxiety_current$n),
                       Current_Mood = sum(w1_dx_mood_current$n),
                       Current_ED = sum(w1_dx_ed_current$n),
                       Past_Anx = sum(w1_dx_anxiety_past$n),
                       Past_Mood = sum(w1_dx_mood_past$n),
                       Past_ED = sum(w1_dx_ed_past$n),
                       Current_Comorbid = sum(w1_comorbid_current$n),
                       Past_Comorbid = sum(w1_comorbid_past),
                       PC_Anx = sum(w1_anx_pc$n),
                       PC_Mood = sum(w1_mood_pc$n),
                       PC_ED = sum(w1_ed_pc$n),
                       Anx_New = sum(w1_dx_anxiety$n),
                       Mood_New = sum(w1_dx_mood$n),
                       ED_New = sum(w1_dx_ed$n))


w2_count <- data.frame(Total_Anx = sum(w2_dx_anxiety$n),
                       Total_Mood = sum(w2_dx_mood$n),
                       Total_ED = sum(w2_dx_ed$n),
                       Current_Anx = sum(w2_dx_anxiety_current$n),
                       Current_Mood = sum(w2_dx_mood_current$n),
                       Current_ED = sum(w2_dx_ed_current$n),
                       Past_Anx = sum(w2_dx_anxiety_past$n),
                       Past_Mood = sum(w2_dx_mood_past$n),
                       Past_ED = sum(w2_dx_ed_past$n),
                       Current_Comorbid = sum(w2_comorbid_current$n),
                       Past_Comorbid = sum(w2_comorbid_past),
                       PC_Anx = sum(w2_anx_pc$n),
                       PC_Mood = sum(w2_mood_pc$n),
                       PC_ED = sum(w2_ed_pc$n),
                       Anx_New = sum(w2_dx_anxiety$n)-sum(w2_reoccuring_anx$n),
                       Mood_New = sum(w2_dx_mood$n)-sum(w2_reoccuring_mood$n),
                       ED_New = sum(w2_dx_ed$n)-sum(w2_reoccuring_ed$n))


w3_count <- data.frame(Total_Anx = sum(w3_dx_anxiety$n),
                       Total_Mood = sum(w3_dx_mood$n),
                       Total_ED = sum(w3_dx_ed$n),
                       Current_Anx = sum(w3_dx_anxiety_current$n),
                       Current_Mood = sum(w3_dx_mood_current$n),
                       Current_ED = sum(w3_dx_ed_current$n),
                       Past_Anx = sum(w3_dx_anx_past$n),
                       Past_Mood = sum(w3_dx_mood_past$n),
                       Past_ED = sum(w3_dx_ed_past$n),
                       Current_Comorbid = sum(w3_comorbid_current$n),
                       Past_Comorbid = sum(w3_comorbid_past),
                       PC_Anx = sum(w3_anx_pc$n),
                       PC_Mood = sum(w3_mood_pc$n),
                       PC_ED = sum(w3_ed_pc$n),
                       Anx_New = sum(w3_dx_anxiety$n)-sum(w3_reoccuring_anx$n),
                       Mood_New = sum(w3_dx_mood$n)-sum(w3_reoccuring_mood$n),
                       ED_New = sum(w3_dx_ed)$n-sum(w3_reoccuring_ed$n)))


w4_count <- data.frame(Total_Anx = sum(w4_dx_anxiety$n),
                       Total_Mood = sum(w4_dx_mood$n),
                       Total_ED = sum(w4_dx_ed$n),
                       Current_Anx = sum(w4_dx_anxiety_current$n),
                       Current_Mood = sum(w4_dx_mood_current$n),
                       Current_ED = sum(w4_dx_ed_current$n),
                       Past_Anx = sum(w4_dx_anx_past$n),
                       Past_Mood = sum(w4_dx_mood_past$n),
                       Past_ED = sum(w4_dx_ed_past$n),
                       Current_Comorbid = sum(w4_comorbid_current$n),
                       Past_Comorbid = sum(w4_comorbid_past),
                       PC_Anx = sum(w4_anx_pc$n),
                       PC_Mood = sum(w4_mood_pc$n),
                       PC_ED = sum(w4_ed_pc$n),
                       Anx_New = sum(w4_dx_anxiety$n)-sum(w4_reoccuring_anx$n),
                       Mood_New = sum(w4_dx_mood$n)-sum(w4_reoccuring_mood$n),
                       ED_New = sum(w4_dx_ed$n)-sum(w4_reoccuring_ed$n)))








```

## Question 8: How many participants met for the same dx across waves?
```{r 8}
## How many participants met for the same dx across waves? 

## BY DX 

id_recurrences <- dx_full %>% group_by(dx, ID, dx_type) %>% tally()

across_4_waves <-  id_recurrences[which(id_recurrences$n=="4"),]
across_3_waves <-  id_recurrences[which(id_recurrences$n=="3"),]
across_2_waves <-  id_recurrences[which(id_recurrences$n=="2"),]
across_1_waves <-  id_recurrences[which(id_recurrences$n=="1"),]
across_4_waves <- across_4_waves[!duplicated(across_4_waves$ID), ]
across_3_waves <- across_3_waves[!duplicated(across_3_waves$ID), ] 
across_2_waves <- across_2_waves[!duplicated(across_2_waves$ID), ] 
across_1_waves <- across_1_waves[!duplicated(across_1_waves$ID), ] 

# BY CLASSIFICATION

id_recurrences <- dx_full %>% group_by(dx_type, ID) %>% tally()

across_4_waves <-  id_recurrences[which(id_recurrences$n=="4"),]
across_3_waves <-  id_recurrences[which(id_recurrences$n=="3"),]
across_2_waves <-  id_recurrences[which(id_recurrences$n=="2"),]
across_1_waves <-  id_recurrences[which(id_recurrences$n=="1"),]

across_4_waves <- across_4_waves[!duplicated(across_4_waves$ID), ] 
across_3_waves <- across_3_waves[!duplicated(across_3_waves$ID), ] 
across_2_waves <- across_2_waves[!duplicated(across_2_waves$ID), ] 
across_1_waves <- across_1_waves[!duplicated(across_1_waves$ID), ] 

across_4_waves_anx <- across_4_waves[which(across_4_waves$dx_type=="1"),]
across_3_waves_anx <- across_3_waves[which(across_3_waves$dx_type=="1"),]
across_2_waves_anx <-  across_2_waves[which(across_2_waves$dx_type=="1"),]
across_1_waves_anx <-  across_1_waves[which(across_1_waves$dx_type=="1"),]

across_4_waves_mood <- across_4_waves[which(across_4_waves$dx_type=="2"),]
across_3_waves_mood <- across_3_waves[which(across_3_waves$dx_type=="2"),]
across_2_waves_mood <-  across_2_waves[which(across_2_waves$dx_type=="2"),]
across_1_waves_mood <-  across_1_waves[which(across_1_waves$dx_type=="2"),]

across_4_waves_ed <- across_4_waves[which(across_4_waves$dx_type=="3"),]
across_3_waves_ed <- across_3_waves[which(across_3_waves$dx_type=="3"),]
across_2_waves_ed <-  across_2_waves[which(across_2_waves$dx_type=="3"),]
across_1_waves_ed <-  across_1_waves[which(across_1_waves$dx_type=="3"),]

```

```{r self-harm + dx}

## cleaning DSHI doc 

## changing any -3 to NA in DSHI doc 

dshi[dshi=="-3"] <- "NA"

## filtering out IDs who have NA for date of endorsement and self-harm (meaning they didn't meet for anything)

dshi <- dshi %>% filter(dshi$Date_Endorsement != "NA")

dshi <- dshi %>% filter(dshi$Self_Harm != "NA")

## creating a doc with just ID and the wave they met 

dshi <- dshi %>%
  select("ID", "Wave")

dshi <-dshi %>%
  mutate(no_underscores=paste0("TAG",
                               substring(ID,first=5,last=length(ID))))

colnames(dshi)[3] <- "ID"
dshi <-dshi[, -1]
dshi <-dshi[c(2, 1)]


## relabeling ACE endorsements to wave 3's 

dshi[dshi=="3.5 (Month 1)"] <- "3"
dshi[dshi=="3.5 (Month 2)"] <- "3"
dshi[dshi=="3.5"] <- "3"

## creating separate wave docs for dshi endorsements 

dshi_w1 <-  dshi[which(dshi$Wave=="1"),]
dshi_w2 <-  dshi[which(dshi$Wave=="2"),]
dshi_w3 <-  dshi[which(dshi$Wave=="3"),]

## changing the class of Wave to integer 

dshi_w1$Wave <-  as.integer(dshi_w1$Wave)
dshi_w2$Wave <-  as.integer(dshi_w2$Wave)
dshi_w3$Wave <-  as.integer(dshi_w3$Wave)

dshi <-dshi %>%
  mutate(no_underscores=paste0("TAG",
                               substring(ID,first=5,last=length(ID))))

colnames(dshi)[3] <- "ID"
dshi <-dshi[, -1]
dshi <-dshi[c(2, 1)]

dshi_w1 <- dshi_w1[!duplicated(dshi_w1$ID), ] 
dshi_w2 <- dshi_w2[!duplicated(dshi_w2$ID), ] 
dshi_w3 <- dshi_w3[!duplicated(dshi_w3$ID), ]

dshi_w3 <- dshi_w3[-c(1),]

```

## SH + Dx 
```{r SH}

## creating docs for folks who endorsed self-harm and met for a dx in the same wave 

w1_sh_dx <- w1_dx[w1_dx$ID %in% dshi_w1$ID,]
w2_sh_dx <- w2_dx[w2_dx$ID %in% dshi_w2$ID,]
w3_sh_dx <- w3_dx[w3_dx$ID %in% dshi_w3$ID,]

w1_sh_dx <- w1_sh_dx[!duplicated(w1_sh_dx$ID), ] ## 7
w2_sh_dx <- w2_sh_dx[!duplicated(w2_sh_dx$ID), ] ## 17
w3_sh_dx <- w3_sh_dx[!duplicated(w3_sh_dx$ID), ] ## 22

## creating docs for folks who endorsed self-harm but did not meet for dx 

w1_sh_no_dx <- subset(dshi_w1, !(ID %in% w1_sh_dx$ID))
w2_sh_no_dx <- subset(dshi_w2, !(ID %in% w2_sh_dx$ID))
w3_sh_no_dx <- subset(dshi_w3, !(ID %in% w3_sh_dx$ID))

w1_sh_no_dx <- w1_sh_no_dx[!duplicated(w1_sh_no_dx$ID), ] ## 13
w2_sh_no_dx <- w2_sh_no_dx[!duplicated(w2_sh_no_dx$ID), ] ## 3
w3_sh_no_dx <- w3_sh_no_dx[!duplicated(w3_sh_no_dx$ID), ]  ## 14

## anx + self-harm 

w1_sh_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% dshi_w1$ID,] ## 5
w2_sh_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% dshi_w2$ID,] ## 14
w3_sh_anx <- w3_dx_anxiety[w3_dx_anxiety$ID %in% dshi_w3$ID,] ## 22 

## mood + self-harm 

w1_sh_mood <- w1_dx_mood[w1_dx_mood$ID %in% dshi_w1$ID,] ## 3
w2_sh_mood <- w2_dx_mood[w2_dx_mood$ID %in% dshi_w2$ID,] ## 13
w3_sh_mood <- w3_dx_mood[w3_dx_mood$ID %in% dshi_w3$ID,] ## 18 

## mood + anx + sh 

w1_sh_anx_mood <- w1_sh_anx[w1_sh_anx$ID %in% w1_sh_mood$ID,] ## 1
w2_sh_anx_mood <- w2_sh_anx[w2_sh_anx$ID %in% w1_sh_mood$ID,] ## 0 
w3_sh_anx_mood <- w3_sh_anx[w3_sh_anx$ID %in% w1_sh_mood$ID,]  ## 1

```

```{r visualizing for all dx}

## visualizing by diagnoses participant

## creating wave variable 


dx_full$Wave_1_C <- paste(dx_full$W1_current)
dx_full$Wave_1_P <- paste(dx_full$W1_past)
dx_full$Wave_2_C <- paste(dx_full$W2_current)
dx_full$Wave_2_P <- paste(dx_full$W2_past)
dx_full$Wave_3_C <- paste(dx_full$W3_current)
dx_full$Wave_3_P <- paste(dx_full$W3_past)

dx_full$Wave_1_C[dx_full$Wave_1_C=="1"] = "1"
dx_full$Wave_1_P[dx_full$Wave_1_P=="1"] = "1"
dx_full$Wave_2_C[dx_full$Wave_2_C=="1"] = "2"
dx_full$Wave_2_P[dx_full$Wave_2_P=="1"] = "2"
dx_full$Wave_3_C[dx_full$Wave_3_C=="1"] = "3"
dx_full$Wave_3_P[dx_full$Wave_3_P=="1"] = "3"

dx_full <- dx_full %>%
  unite("Wave", Wave_1_C:Wave_1_P:Wave_2_C:Wave_2_P:Wave_3_C:Wave_3_P)

dx_full <- dx_full %>%
  mutate(Wave=ifelse(Wave=="1_NA_NA_NA_NA_NA", "1",
                     ifelse(Wave=="NA_1_NA_NA_NA_NA", "1",
                            ifelse(Wave=="NA_NA_2_NA_NA_NA", "2",
                                   ifelse(Wave=="NA_NA_NA_2_NA_NA", "2",
                                          ifelse(Wave=="NA_NA_NA_NA_3_NA", "3",
                                                 ifelse(Wave=="NA_NA_NA_NA_NA_3", "3",
                                                        Wave)))))))

dx_full$Wave <- as.factor(dx_full$Wave)
dx_full$dx_type <- as.integer(dx_full$dx_type)

dx_full$onset_age_months_decimal <- dx_full$onset_age_months/12

dx_full$onset_age <- dx_full$onset_age_years + dx_full$onset_age_months_decimal

dx_full <-  dx_full[-c(1,2),]

dx_by_px<- ggplot(dx_full,
                           aes(x=dx_type,
                               y=onset_age,
                               group=ID,
                               col=Wave,
                               shape=Wave)) + 
  geom_point(alpha=1) + 
  geom_line(alpha=.4)+
  theme(axis.text.y = element_blank()) +
  scale_color_manual(name= "Wave",
                     labels = c("W1", "W2", "W3"),
                     values = c("#5445b1", "#749dae", "#f3c483"))  +
  scale_shape_manual(name= "Wave",
              labels= c("W1", "W2", "W3"),
              values = c(0, 1, 2))+
  ylab("Age of Onset (years)") +
	ylim(5, 16) +
  xlab("Diagnosis Type")+
  scale_x_continuous(breaks = 1:3,
  labels = paste0(c("Anxiety", "Mood", "Eating")))+
  theme_minimal()


```

```{r visualizing just depressive disorders}

## creating document with just depressive disorders 

dx_depressive_MDD <-  dx_full[which(dx_full$dx=="MDD"),]
dx_depressive_DYS <-  dx_full[which(dx_full$dx=="DYS"),]
dx_depressive_DNOS <-  dx_full[which(dx_full$dx=="DNOS"),]

dx_depressive <- full_join(dx_depressive_MDD, dx_depressive_DNOS)
dx_depressive <- full_join(dx_depressive, dx_depressive_DYS)

dx_depressive$dx[dx_depressive$dx=="MDD"] = "1"
dx_depressive$dx[dx_depressive$dx=="DYS"] = "2"
dx_depressive$dx[dx_depressive$dx=="DNOS"] = "3"


dx_depressive$Wave_1_C <- paste(dx_depressive$W1_current)
dx_depressive$Wave_1_P <- paste(dx_depressive$W1_past)
dx_depressive$Wave_2_C <- paste(dx_depressive$W2_current)
dx_depressive$Wave_2_P <- paste(dx_depressive$W2_past)
dx_depressive$Wave_3_C <- paste(dx_depressive$W3_current)
dx_depressive$Wave_3_P <- paste(dx_depressive$W3_past)

dx_depressive$Wave_1_C[dx_depressive$Wave_1_C=="1"] = "1"
dx_depressive$Wave_1_P[dx_depressive$Wave_1_P=="1"] = "1"
dx_depressive$Wave_2_C[dx_depressive$Wave_2_C=="1"] = "2"
dx_depressive$Wave_2_P[dx_depressive$Wave_2_P=="1"] = "2"
dx_depressive$Wave_3_C[dx_depressive$Wave_3_C=="1"] = "3"
dx_depressive$Wave_3_P[dx_depressive$Wave_3_P=="1"] = "3"

dx_depressive <- dx_depressive %>%
  unite("Wave", Wave_1_C:Wave_1_P:Wave_2_C:Wave_2_P:Wave_3_C:Wave_3_P)

dx_depressive <- dx_depressive %>%
  mutate(Wave=ifelse(Wave=="1_NA_NA_NA_NA_NA", "1",
                     ifelse(Wave=="NA_1_NA_NA_NA_NA", "1",
                            ifelse(Wave=="NA_NA_2_NA_NA_NA", "2",
                                   ifelse(Wave=="NA_NA_NA_2_NA_NA", "2",
                                          ifelse(Wave=="NA_NA_NA_NA_3_NA", "3",
                                                 ifelse(Wave=="NA_NA_NA_NA_NA_3", "3",
                                                        Wave)))))))

dx_depressive$Wave <- as.factor(dx_depressive$Wave)
dx_depressive$dx <- as.integer(dx_depressive$dx)

dx_depressive$onset_age_months_decimal <- dx_depressive$onset_age_months/12

dx_depressive$onset_age <- dx_depressive$onset_age_years + dx_depressive$onset_age_months_decimal

dx_depressive <-  dx_depressive[(-1),]

dep_dx_by_px<- ggplot(dx_depressive,
                           aes(x=dx,
                               y=onset_age,
                               group=ID,
                               col=Wave,
                               shape=Wave)) + 
  geom_point(alpha=1) + 
  geom_line(alpha=.4)+
  theme(axis.text.y = element_blank()) +
  scale_color_manual(name= "Wave",
                     labels = c("W1", "W2", "W3"),
                     values = c("#5445b1", "#749dae", "#f3c483"))  +
  scale_shape_manual(name= "Wave",
              labels= c("W1", "W2", "W3"),
              values = c(0, 1, 2))+
  ylab("Age of Onset (years)") +
	ylim(5, 16) +
  xlab("Diagnosis Type")+
  scale_x_continuous(breaks = 1:3,
  labels = paste0(c("MDD", "DYS", "DNOS")))+
  theme_minimal()


```

