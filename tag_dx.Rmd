---
title: "tag dx"
author: "clare f mccann"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    df_print: paged
    highlight: tango
    theme: united
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = FALSE, fig.path = "figs/", dpi = 300)

options(scipen=999)
```

# load packages
```{r}
library(pacman)
pacman::p_load(tidyverse, purrr, fs, reactable, ggplot2, install = TRUE)
```

# define aesthetics
```{r}
palette = c("#ffb800", "#e64626", "#00a896", "#165f8d", "#AE2012")

plot_aes = theme_minimal() +
  theme(legend.position = "top",
        legend.text = element_text(size = 8),
        text = element_text(size = 10, family = "Futura Medium"),
        axis.text = element_text(color = "black"),
        axis.line = element_line(colour = "black"),
        axis.ticks.y = element_blank())
```

## Set root path for Clare (laptop)
```{r}
root_path="/Users/clare/Desktop/projects/tag_dx/working_docs/"
```

## Set root path for work computer 
```{r}
root_path="~/Desktop/Projects/dx/working_docs/"
```

```{r Load data sets}
##pulling CSV files & calculating cronbach alpha
dx_full<-read.csv(paste0(root_path,"Lifetime_Diagnoses.csv"),
                  stringsAsFactors = FALSE) 

dx_names<-read.csv(paste0(root_path,"dx_names.csv"),
                  stringsAsFactors = FALSE)

dshi <-read.csv(paste0(root_path,"DSHI_All_Waves.csv"),
                  stringsAsFactors = FALSE) 

```

## Optional: checking for new dx names
```{r new diagnoses??}

## in working docs, paste the dx column from "Lifetime Dx Data.csv" into "Dx Names"

## creating doc to get each individual acronym used 
dx_names <- unique(dx_names)

## exporting doc to see if there are any new mutations to add below 
write.csv(dx_names, "dx_names.csv")

```

## Cleaning Dx Data
```{r cleaning}
## (anxiety = 1, mood = 2, disordered eating = 3) as of 09/08/2021

dx_full$dx_type <- dx_full$dx

dx_full <- dx_full %>%
  mutate(dx_type=ifelse(dx_type=="MDD", 2,
                          ifelse(dx_type=="SocP", 1,
                                 ifelse(dx_type=="ADDM", 2,
                                        ifelse(dx_type=="SimP", 1,
                                               ifelse(dx_type=="ENU", 1,
                                                      ifelse(dx_type=="GAD", 1,
                                                             ifelse(dx_type=="OCD", 1,
                                                                    ifelse(dx_type=="DNOS", 2,
                                                                           ifelse(dx_type=="PTSD", 1,
                                                                                  ifelse(dx_type=="AG", 1,
                                                                                         ifelse(dx_type=="PD", 1,
                                                                                                ifelse(dx_type=="AN", 3,
                                                                                                       ifelse(dx_type=="EDNOS", 3,
                                                                                                                     ifelse(dx_type=="BU", 3,
                                                                                                                            ifelse(dx_type=="ANOS", 1, 
                                                                                                                                          ifelse(dx_type=="BP2", 2,
                                                                                                                                                        ifelse(dx_type=="BP1", 2,
                                                                                                                                                                      ifelse(dx_type=="ADA", 1,
                                                                                                                                                                             ifelse(dx_type=="ASD", 1,                                                                                      ifelse(dx_type=="Schizo_Affect_Dep", 2,
                                                                                                                                                                                                  ifelse(dx_type=="DYS", 2,
                                                                                                                                                                                                         ifelse(dx_type=="ManEp", 2,
                                                                                                                                                                                                                ifelse(dx_type=="HypoEp", 2,
                                                                                                                                                                                                                       ifelse(dx_type=="PD_AG", 1,
                                                                                                                                                                                                                                     ifelse(dx_type=="SepAnx", 1,
                                                                                                                                                                                                                                            ifelse(dx_type=="MDD_B", 2,
                                                                                                                                                                                                                                                          ifelse(dx_type=="MixedEp_Psychotic", 2, 
                                                                                                                                                                                                                                                                 ifelse(dx_type=="Schizo_Affect_Bi", 2,
                                                                                                                                                                                                                                                                        ifelse(dx_type=="ADADM", 4,
                                                                                                                                                                                                                                                                 dx_type))))))))))))))))))))))))))))))

## creating wave docs 

## W1 

w1_dx_current <-  dx_full[which(dx_full$W1_current=="1"),]
w1_dx_past <- dx_full[which(dx_full$W1_past=="1"),]
w1_dx <- full_join(w1_dx_current, w1_dx_past)

## W2

w2_dx_current <-  dx_full[which(dx_full$W2_current=="1"),]
w2_dx_past <- dx_full[which(dx_full$W2_past=="1"),]
w2_dx <- full_join(w2_dx_current, w2_dx_past)
                                                                    
## W3

w3_dx_current <-  dx_full[which(dx_full$W3_current=="1"),]
w3_dx_past <- dx_full[which(dx_full$W3_past=="1"),]
w3_dx <- full_join(w3_dx_current, w3_dx_past)

## W4

w4_dx_current <-  dx_full[which(dx_full$W4_current=="1"),]
w4_dx_past <- dx_full[which(dx_full$W4_past=="1"),]
w4_dx <- full_join(w4_dx_current, w4_dx_past)
         
```

## Question 1: How many participants met for any anxiety/mood/ed disorder in each wave?
```{r 1}

## How many participants met for any anxiety/mood/ed disorder in each wave?

## W1 

w1_dx_anxiety <-  w1_dx[which(w1_dx$dx_type=="1"),]
w1_dx_mood <- w1_dx[which(w1_dx$dx_type=="2"),]
w1_dx_ed <- w1_dx[which(w1_dx$dx_type=="3"),]

w1_dx_anxiety <- w1_dx_anxiety[!duplicated(w1_dx_anxiety$ID), ]  
w1_dx_mood <- w1_dx_mood[!duplicated(w1_dx_mood$ID), ]  
w1_dx_ed <- w1_dx_ed[!duplicated(w1_dx_ed$ID), ]

w1_dx_anxiety <- w1_dx_anxiety %>%
  count(ID)
w1_dx_mood <- w1_dx_mood %>%
  count(ID)
w1_dx_ed <- w1_dx_ed %>%
  count(ID)

## W2 

w2_dx_anxiety <-  w2_dx[which(w2_dx$dx_type=="1"),]
w2_dx_mood <- w2_dx[which(w2_dx$dx_type=="2"),]
w2_dx_ed <- w2_dx[which(w2_dx$dx_type=="3"),]

w2_dx_anxiety <- w2_dx_anxiety[!duplicated(w2_dx_anxiety$ID), ]  
w2_dx_mood <- w2_dx_mood[!duplicated(w2_dx_mood$ID), ]   
w2_dx_ed <- w2_dx_ed[!duplicated(w2_dx_ed$ID), ]  

w2_dx_anxiety <- w2_dx_anxiety %>%
  count(ID)
w2_dx_mood <- w2_dx_mood %>%
  count(ID)
w2_dx_ed <- w2_dx_ed %>%
  count(ID)


## W3 

w3_dx_anxiety <-  w3_dx[which(w3_dx$dx_type=="1"),]
w3_dx_mood <- w3_dx[which(w3_dx$dx_type=="2"),]
w3_dx_ed <- w3_dx[which(w3_dx$dx_type=="3"),]

w3_dx_anxiety <- w3_dx_anxiety[!duplicated(w3_dx_anxiety$ID), ]  
w3_dx_mood <- w3_dx_mood[!duplicated(w3_dx_mood$ID), ]  
w3_dx_ed <- w3_dx_ed[!duplicated(w3_dx_ed$ID), ] 

w3_dx_anxiety <- w3_dx_anxiety %>%
  count(ID)
w3_dx_mood <- w3_dx_mood %>%
  count(ID)
w3_dx_ed <- w3_dx_ed %>%
  count(ID)

## w4 

w4_dx_anxiety <-  w4_dx[which(w4_dx$dx_type=="1"),]
w4_dx_mood <- w4_dx[which(w4_dx$dx_type=="2"),]
w4_dx_ed <- w4_dx[which(w4_dx$dx_type=="3"),]
w4_dx_co <- w4_dx[which(w4_dx$dx_type=="4"),]

w4_dx_anxiety <- w4_dx_anxiety[!duplicated(w4_dx_anxiety$ID), ]  
w4_dx_mood <- w4_dx_mood[!duplicated(w4_dx_mood$ID), ]  
w4_dx_ed <- w4_dx_ed[!duplicated(w4_dx_ed$ID), ] 

w4_dx_anxiety <- w4_dx_anxiety %>%
  count(ID)
w4_dx_mood <- w4_dx_mood %>%
  count(ID)
w4_dx_ed <- w4_dx_ed %>%
  count(ID)

```

## Question 2: How many participants are currently experiencing anxiety/mood/disordered eating?
```{r 2}
## How many participants are currently experiencing anxiety/mood/disordered eating? 

## W1 

# number of current diagnoses 

w1_dx_anxiety_current_full <-  w1_dx_current[which(w1_dx_current$dx_type=="1"),]
w1_dx_mood_current_full <- w1_dx_current[which(w1_dx_current$dx_type=="2"),]
w1_dx_ed_current_full <- w1_dx_current[which(w1_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w1_dx_anxiety_current <- w1_dx_anxiety_current_full[!duplicated(w1_dx_anxiety_current_full$ID), ] 
w1_dx_mood_current <- w1_dx_mood_current_full[!duplicated(w1_dx_mood_current_full$ID), ]   
w1_dx_ed_current <- w1_dx_ed_current_full[!duplicated(w1_dx_ed_current_full$ID), ] 

w1_dx_anxiety_current <- w1_dx_anxiety_current %>%
  count(ID)
w1_dx_mood_current <- w1_dx_mood_current %>%
  count(ID)
w1_dx_ed_current <- w1_dx_ed_current %>%
  count(ID)

## W2

# number of current diagnoses 

w2_dx_anxiety_current_full <-  w2_dx_current[which(w2_dx_current$dx_type=="1"),]
w2_dx_mood_current_full <- w2_dx_current[which(w2_dx_current$dx_type=="2"),]
w2_dx_ed_current_full <- w2_dx_current[which(w2_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w2_dx_anxiety_current <- w2_dx_anxiety_current_full[!duplicated(w2_dx_anxiety_current_full$ID), ] 
w2_dx_mood_current <- w2_dx_mood_current_full[!duplicated(w2_dx_mood_current_full$ID), ] 
w2_dx_ed_current <- w2_dx_ed_current_full[!duplicated(w2_dx_ed_current_full$ID), ] 

w2_dx_anxiety_current <- w2_dx_anxiety_current %>%
  count(ID)
w2_dx_mood_current <- w2_dx_mood_current %>%
  count(ID)
w2_dx_ed_current <- w2_dx_ed_current %>%
  count(ID)

## W3

# number of current diagnoses 

w3_dx_anxiety_current_full <-  w3_dx_current[which(w3_dx_current$dx_type=="1"),]
w3_dx_mood_current_full <- w3_dx_current[which(w3_dx_current$dx_type=="2"),]
w3_dx_ed_current_full <- w3_dx_current[which(w3_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w3_dx_anxiety_current <- w3_dx_anxiety_current_full[!duplicated(w3_dx_anxiety_current_full$ID), ] 
w3_dx_mood_current <- w3_dx_mood_current_full[!duplicated(w3_dx_mood_current_full$ID), ] 
w3_dx_ed_current <- w3_dx_ed_current_full[!duplicated(w3_dx_ed_current_full$ID), ] 

w3_dx_anxiety_current <- w3_dx_anxiety_current %>%
  count(ID)
w3_dx_mood_current <- w3_dx_mood_current %>%
  count(ID)
w3_dx_ed_current <- w3_dx_ed_current %>%
  count(ID)

## W4

# number of current diagnoses 

w4_dx_anxiety_current_full <-  w4_dx_current[which(w4_dx_current$dx_type=="1"),]
w4_dx_mood_current_full <- w4_dx_current[which(w4_dx_current$dx_type=="2"),]
w4_dx_ed_current_full <- w4_dx_current[which(w4_dx_current$dx_type=="3"),]

# number of px who met for at least one current diagnosis 

w4_dx_anxiety_current <- w4_dx_anxiety_current_full[!duplicated(w4_dx_anxiety_current_full$ID), ] 
w4_dx_mood_current <- w4_dx_mood_current_full[!duplicated(w4_dx_mood_current_full$ID), ] 
w4_dx_ed_current <- w4_dx_ed_current_full[!duplicated(w4_dx_ed_current_full$ID), ] 

w4_dx_anxiety_current <- w4_dx_anxiety_current %>%
  count(ID)
w4_dx_mood_current <- w4_dx_mood_current %>%
  count(ID)
w4_dx_ed_current <- w4_dx_ed_current %>%
  count(ID)

```

## Question 3: How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed currently?
```{r 3}
## How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed currently?

## W1 

w1_comorbid_current_ma <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_anxiety_current$ID,]
w1_comorbid_current_ma <- w1_comorbid_current_ma[!duplicated(w1_comorbid_current_ma$ID), ] 
w1_comorbid_current_ae <- w1_dx_anxiety_current[w1_dx_anxiety_current$ID %in% w1_dx_ed_current$ID,]
w1_comorbid_current_ae <- w1_comorbid_current_ae[!duplicated(w1_comorbid_current_ae$ID), ] 
w1_comorbid_current_me <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_ed_current$ID,]
w1_comorbid_current_me <- w1_comorbid_current_me[!duplicated(w1_comorbid_current_me$ID), ] 
w1_comorbid_current <- full_join(w1_comorbid_current_ae, w1_comorbid_current_ma)
w1_comorbid_current <- full_join(w1_comorbid_current, w1_comorbid_current_me)
w1_comorbid_current <- w1_comorbid_current[!duplicated(w1_comorbid_current$ID), ] 

w1_comorbid_current <- w1_comorbid_current%>%
  count(ID)

# W2 

w2_comorbid_current_ma <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_anxiety_current$ID,]
w2_comorbid_current_ma <- w2_comorbid_current_ma[!duplicated(w2_comorbid_current_ma$ID), ] 
w2_comorbid_current_ae <- w2_dx_anxiety_current[w2_dx_anxiety_current$ID %in% w2_dx_ed_current$ID,]
w2_comorbid_current_ae <- w2_comorbid_current_ae[!duplicated(w2_comorbid_current_ae$ID), ]
w2_comorbid_current_me <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_ed_current$ID,] 
w2_comorbid_current_me <- w2_comorbid_current_me[!duplicated(w2_comorbid_current_me$ID), ]
w2_comorbid_current <- full_join(w2_comorbid_current_ae, w2_comorbid_current_ma)
w2_comorbid_current <- full_join(w2_comorbid_current, w2_comorbid_current_me) 
w2_comorbid_current <- w2_comorbid_current[!duplicated(w2_comorbid_current$ID), ] 

w2_comorbid_current <- w2_comorbid_current%>%
  count(ID)

## W3 

w3_comorbid_current_ma <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_anxiety_current$ID,] 
w3_comorbid_current_ma <- w3_comorbid_current_ma[!duplicated(w3_comorbid_current_ma$ID), ]
w3_comorbid_current_ae <- w3_dx_anxiety_current[w3_dx_anxiety_current$ID %in% w3_dx_ed_current$ID,]
w3_comorbid_current_ae <- w3_comorbid_current_ae[!duplicated(w3_comorbid_current_ae$ID), ]
w3_comorbid_current_me <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_ed_current$ID,] 
w3_comorbid_current_me <- w3_comorbid_current_me[!duplicated(w3_comorbid_current_me$ID), ]
w3_comorbid_current <- full_join(w3_comorbid_current_ae, w3_comorbid_current_ma)
w3_comorbid_current <- full_join(w3_comorbid_current, w3_comorbid_current_me)
w3_comorbid_current <- w3_comorbid_current[!duplicated(w3_comorbid_current$ID), ] 

w3_comorbid_current <- w3_comorbid_current%>%
  count(ID)

## W4

w4_comorbid_current_ma <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_anxiety_current$ID,]
w4_comorbid_current_ma <- w4_comorbid_current_ma[!duplicated(w4_comorbid_current_ma$ID), ] 
w4_comorbid_current_ae <- w4_dx_anxiety_current[w4_dx_anxiety_current$ID %in% w4_dx_ed_current$ID,]
w4_comorbid_current_ae <- w4_comorbid_current_ae[!duplicated(w4_comorbid_current_ae$ID), ]  
w4_comorbid_current_me <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_ed_current$ID,]
w4_comorbid_current_me <- w4_comorbid_current_me[!duplicated(w4_comorbid_current_me$ID), ]
w4_comorbid_current <- full_join(w4_comorbid_current_ae, w4_comorbid_current_ma)
w4_comorbid_current <- full_join(w4_comorbid_current, w4_comorbid_current_me) 
w4_comorbid_current <- w4_comorbid_current[!duplicated(w4_comorbid_current$ID), ] 

w4_comorbid_current <- w4_comorbid_current%>%
  count(ID)
```

## Question 4: How many participants have experienced anxiety/mood/disordered eating in the past two years? 
```{r 4}
## How many participants have experienced anxiety/mood/disordered eating in the past two years? 

## W1 

# number of past diagnoses 

w1_dx_anxiety_past_full <-  w1_dx_past[which(w1_dx_past$dx_type=="1"),]
w1_dx_mood_past_full <- w1_dx_past[which(w1_dx_past$dx_type=="2"),]
w1_dx_ed_past_full <- w1_dx_past[which(w1_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w1_dx_anxiety_past <- w1_dx_anxiety_past_full[!duplicated(w1_dx_anxiety_past_full$ID), ]  
w1_dx_mood_past <- w1_dx_mood_past_full[!duplicated(w1_dx_mood_past_full$ID), ]  
w1_dx_ed_past <- w1_dx_ed_past_full[!duplicated(w1_dx_ed_past_full$ID), ] 

w1_dx_anxiety_past <- w1_dx_anxiety_past %>%
  count(ID)
w1_dx_mood_past <- w1_dx_mood_past %>%
  count(ID)
w1_dx_ed_past <- w1_dx_ed_past %>%
  count(ID)

## W2

# number of past diagnoses 

w2_dx_anxiety_past_full <-  w2_dx_past[which(w2_dx_past$dx_type=="1"),]
w2_dx_mood_past_full <- w2_dx_past[which(w2_dx_past$dx_type=="2"),]
w2_dx_ed_past_full <- w2_dx_past[which(w2_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w2_dx_anxiety_past <- w2_dx_anxiety_past_full[!duplicated(w2_dx_anxiety_past_full$ID), ] 
w2_dx_mood_past <- w2_dx_mood_past_full[!duplicated(w2_dx_mood_past_full$ID), ]  
w2_dx_ed_past <- w2_dx_ed_past_full[!duplicated(w2_dx_ed_past_full$ID), ] 

w2_dx_anxiety_past <- w2_dx_anxiety_past %>%
  count(ID)
w2_dx_mood_past <- w2_dx_mood_past %>%
  count(ID)
w2_dx_ed_past <- w2_dx_ed_past %>%
  count(ID)

## W3

# number of past diagnoses 

w3_dx_anxiety_past_full <-  w3_dx_past[which(w3_dx_past$dx_type=="1"),]
w3_dx_mood_past_full <- w3_dx_past[which(w3_dx_past$dx_type=="2"),]
w3_dx_ed_past_full <- w3_dx_past[which(w3_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w3_dx_anxiety_past <- w3_dx_anxiety_past_full[!duplicated(w3_dx_anxiety_past_full$ID), ] 
w3_dx_mood_past <- w3_dx_mood_past_full[!duplicated(w3_dx_mood_past_full$ID), ]  
w3_dx_ed_past <- w3_dx_ed_past_full[!duplicated(w3_dx_ed_past_full$ID), ] 

w3_dx_anxiety_past <- w3_dx_anxiety_past %>%
  count(ID)
w3_dx_mood_past <- w3_dx_mood_past %>%
  count(ID)
w3_dx_ed_past <- w3_dx_ed_past %>%
  count(ID)

## W4 

# number of past diagnoses 

w4_dx_anxiety_past_full <-  w4_dx_past[which(w4_dx_past$dx_type=="1"),]
w4_dx_mood_past_full <- w4_dx_past[which(w4_dx_past$dx_type=="2"),]
w4_dx_ed_past_full <- w4_dx_past[which(w4_dx_past$dx_type=="3"),]

# number of participants who met for at least one dx since the past wave

w4_dx_anxiety_past <- w4_dx_anxiety_past_full[!duplicated(w4_dx_anxiety_past_full$ID), ] 
w4_dx_mood_past <- w4_dx_mood_past_full[!duplicated(w4_dx_mood_past_full$ID), ] 
w4_dx_ed_past <- w4_dx_ed_past_full[!duplicated(w4_dx_ed_past_full$ID), ] 

w4_dx_anxiety_past <- w4_dx_anxiety_past %>%
  count(ID)
w4_dx_mood_past <- w4_dx_mood_past %>%
  count(ID)
w4_dx_ed_past <- w4_dx_ed_past %>%
  count(ID)
```

## Question 5: How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed past?
```{r 5}
## How many participants in each wave met for anxiety + mood or anxiety + ed or mood + ed past?

## W1 

w1_comorbid_past_ma <- w1_dx_mood_past[w1_dx_mood_past$ID %in% w1_dx_anxiety_past$ID,] 
w1_comorbid_past_ma <- w1_comorbid_past_ma[!duplicated(w1_comorbid_past_ma$ID), ] 
w1_comorbid_past_ae <- w1_dx_anxiety_past[w1_dx_anxiety_past$ID %in% w1_dx_ed_past$ID,]
w1_comorbid_past_ae <- w1_comorbid_past_ae[!duplicated(w1_comorbid_past_ae$ID), ]
w1_comorbid_past_me <- w1_dx_mood_past[w1_dx_mood_past$ID %in% w1_dx_ed_past$ID,] 
w1_comorbid_past_me <- w1_comorbid_past_me[!duplicated(w1_comorbid_past_me$ID), ]
w1_comorbid_past <- full_join(w1_comorbid_past_ae, w1_comorbid_past_ma)
w1_comorbid_past <- full_join(w1_comorbid_past, w1_comorbid_past_me)
w1_comorbid_past <- w1_comorbid_past[!duplicated(w1_comorbid_past$ID), ] 

w1_comorbid_past <- w1_comorbid_past%>%
  count(ID)

# W2 

w2_comorbid_past_ma <- w2_dx_mood_past[w2_dx_mood_past$ID %in% w2_dx_anxiety_past$ID,] 
w2_comorbid_past_ma <- w2_comorbid_past_ma[!duplicated(w2_comorbid_past_ma$ID), ]
w2_comorbid_past_ae <- w2_dx_anxiety_past[w2_dx_anxiety_past$ID %in% w2_dx_ed_past$ID,]
w2_comorbid_past_ae <- w2_comorbid_past_ae[!duplicated(w2_comorbid_past_ae$ID), ] 
w2_comorbid_past_me <- w2_dx_mood_past[w2_dx_mood_past$ID %in% w2_dx_ed_past$ID,] 
w2_comorbid_past_me <- w2_comorbid_past_me[!duplicated(w2_comorbid_past_me$ID), ] 
w2_comorbid_past <- full_join(w2_comorbid_past_ae, w2_comorbid_past_ma)
w2_comorbid_past <- full_join(w2_comorbid_past, w2_comorbid_past_me)
w2_comorbid_past <- w2_comorbid_past[!duplicated(w2_comorbid_past$ID), ]

w1_comorbid_past <- w1_comorbid_past%>%
  count(ID)

## W3 

w3_comorbid_past_ma <- w3_dx_mood_past[w3_dx_mood_past$ID %in% w3_dx_anxiety_past$ID,] 
w3_comorbid_past_ma <- w3_comorbid_past_ma[!duplicated(w3_comorbid_past_ma$ID), ]
w3_comorbid_past_ae <- w3_dx_anxiety_past[w3_dx_anxiety_past$ID %in% w3_dx_ed_past$ID,] 
w3_comorbid_past_ae <- w3_comorbid_past_ae[!duplicated(w3_comorbid_past_ae$ID), ] 
w3_comorbid_past_me <- w3_dx_mood_past[w3_dx_mood_past$ID %in% w3_dx_ed_past$ID,] 
w3_comorbid_past_me <- w3_comorbid_past_me[!duplicated(w3_comorbid_past_me$ID), ] 
w3_comorbid_past <- full_join(w3_comorbid_past_ae, w3_comorbid_past_ma)
w3_comorbid_past <- full_join(w3_comorbid_past, w3_comorbid_past_me)
w3_comorbid_past <- w3_comorbid_past[!duplicated(w3_comorbid_past$ID), ] 

w1_comorbid_past <- w1_comorbid_past%>%
  count(ID)

## W4

w4_comorbid_past_ma <- w4_dx_mood_past[w4_dx_mood_past$ID %in% w4_dx_anxiety_past$ID,]
w4_comorbid_past_ma <- w4_comorbid_past_ma[!duplicated(w4_comorbid_past_ma$ID), ]
w4_comorbid_past_ae <- w4_dx_anxiety_past[w4_dx_anxiety_past$ID %in% w4_dx_ed_past$ID,] 
w4_comorbid_past_ae <- w4_comorbid_past_ae[!duplicated(w4_comorbid_past_ae$ID), ] 
w4_comorbid_past_me <- w4_dx_mood_past[w4_dx_mood_past$ID %in% w4_dx_ed_past$ID,]
w4_comorbid_past_me <- w4_comorbid_past_me[!duplicated(w4_comorbid_past_me$ID), ] 
w4_comorbid_past <- full_join(w4_comorbid_past_ae, w4_comorbid_past_ma) 
w4_comorbid_past <- full_join(w4_comorbid_past, w4_comorbid_past_me)
w4_comorbid_past <- w4_comorbid_past[!duplicated(w4_comorbid_past$ID), ] 

w1_comorbid_past <- w1_comorbid_past%>%
  count(ID)

```

## Question 6: How many participants met for at least one past and at least one current dx of the same classification in each wave?
```{r 6}
## How many participants met for at least one past and at least one current dx of the same classification in each wave? 

w1_anx_pc <- w1_dx_anxiety_current[w1_dx_anxiety_current$ID %in% w1_dx_anxiety_past$ID, ] 
w1_anx_pc <- w1_anx_pc%>%
  count(ID)
w2_anx_pc <- w2_dx_anxiety_current[w2_dx_anxiety_current$ID %in% w2_dx_anxiety_past$ID, ] 
w2_anx_pc <- w2_anx_pc%>%
  count(ID)
w3_anx_pc <- w3_dx_anxiety_current[w3_dx_anxiety_current$ID %in% w3_dx_anxiety_past$ID, ]  
w3_anx_pc <- w3_anx_pc%>%
  count(ID)
w4_anx_pc <- w4_dx_anxiety_current[w4_dx_anxiety_current$ID %in% w4_dx_anxiety_past$ID, ] 
w4_anx_pc <- w4_anx_pc%>%
  count(ID)

w1_mood_pc <- w1_dx_mood_current[w1_dx_mood_current$ID %in% w1_dx_mood_past$ID, ]  
w1_mood_pc <- w1_mood_pc%>%
  count(ID)
w2_mood_pc <- w2_dx_mood_current[w2_dx_mood_current$ID %in% w2_dx_mood_past$ID, ] 
w2_mood_pc <- w2_mood_pc%>%
  count(ID)
w3_mood_pc <- w3_dx_mood_current[w3_dx_mood_current$ID %in% w3_dx_mood_past$ID, ] 
w3_mood_pc <- w3_mood_pc%>%
  count(ID)
w4_mood_pc <- w4_dx_mood_current[w4_dx_mood_current$ID %in% w4_dx_mood_past$ID, ] 
w4_mood_pc <- w4_mood_pc%>%
  count(ID)

w1_ed_pc <- w1_dx_ed_current[w1_dx_ed_current$ID %in% w1_dx_ed_past$ID, ]  
w1_ed_pc <- w1_ed_pc%>%
  count(ID)
w2_ed_pc <- w2_dx_ed_current[w2_dx_ed_current$ID %in% w2_dx_ed_past$ID, ] 
w2_ed_pc <- w2_ed_pc%>%
  count(ID)
w3_ed_pc <- w3_dx_ed_current[w3_dx_ed_current$ID %in% w3_dx_ed_past$ID, ] 
w3_ed_pc <- w3_ed_pc%>%
  count(ID)
w4_ed_pc <- w4_dx_ed_current[w4_dx_ed_current$ID %in% w4_dx_ed_past$ID, ]  
w4_ed_pc <- w4_ed_pc%>%
  count(ID)
```

## Question 7: How many participants met for something new at each wave?
```{r 7}
## How many participants has reoccuring diagnoses (by classification) at each wave? 

# W2 

w2_reoccuring_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w2_dx_anxiety$ID, ]  
w2_reoccuring_anx<- w2_reoccuring_anx[!duplicated(w2_reoccuring_anx$ID), ]

w2_reoccuring_anx <- w2_reoccuring_anx%>%
  count(ID)


#  W3

w1_w3_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w3_dx_anxiety$ID, ]  
w2_w3_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% w3_dx_anxiety$ID, ] 
w3_reoccuring_anx <- full_join(w1_w3_anx, full_join(w1_w3_anx, w2_w3_anx))
w3_reoccuring_anx<- w3_reoccuring_anx[!duplicated(w3_reoccuring_anx$ID), ]

w3_reoccuring_anx <- w3_reoccuring_anx%>%
  count(ID)

# w4 

w1_w4_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% w4_dx_anxiety$ID, ] 
w2_w4_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% w4_dx_anxiety$ID, ] 
w3_w4_anx <- w3_dx_anxiety[w3_dx_anxiety$ID %in% w4_dx_anxiety$ID, ]  
w4_reoccuring_anx <- full_join(w1_w4_anx, full_join(w2_w4_anx, w3_w4_anx))
w4_reoccuring_anx <- w4_reoccuring_anx[!duplicated(w4_reoccuring_anx$ID), ] 

w4_reoccuring_anx <- w4_reoccuring_anx %>%
  count(ID)


#  W2 

w2_reoccuring_mood <- w1_dx_mood[w1_dx_mood$ID %in% w2_dx_mood$ID, ] 
w2_reoccuring_mood <- w2_reoccuring_mood[!duplicated(w2_reoccuring_mood$ID), ] 

w2_reoccuring_mood <- w2_reoccuring_mood %>%
  count(ID)

# W3

w1_w3_mood <- w1_dx_mood[w1_dx_mood$ID %in% w3_dx_mood$ID, ] 
w2_w3_mood <- w2_dx_mood[w2_dx_mood$ID %in% w3_dx_mood$ID, ] 
w3_reoccuring_mood <- full_join(w1_w3_mood, full_join(w1_w3_mood, w2_w3_mood))
w3_reoccuring_mood <- w3_reoccuring_mood[!duplicated(w3_reoccuring_mood$ID), ] 

w3_reoccuring_mood <- w3_reoccuring_mood %>%
  count(ID)

#  W4 

w1_w4_mood <- w1_dx_mood[w1_dx_mood$ID %in% w4_dx_mood$ID, ]  
w2_w4_mood <- w2_dx_mood[w2_dx_mood$ID %in% w4_dx_mood$ID, ]  
w3_w4_mood <- w3_dx_mood[w3_dx_mood$ID %in% w4_dx_mood$ID, ] 
w4_reoccuring_mood <- full_join(w1_w4_mood, full_join(w2_w4_mood, w3_w4_mood))
w4_reoccuring_mood <- w4_reoccuring_mood[!duplicated(w4_reoccuring_mood$ID), ] 

w4_reoccuring_mood <- w4_reoccuring_mood %>%
  count(ID)

# W2 

w2_reoccuring_ed  <- w1_dx_ed[w1_dx_ed$ID %in% w2_dx_ed$ID, ] 
w2_reoccuring_ed <- w2_reoccuring_ed[!duplicated(w2_reoccuring_ed$ID), ]

w2_reoccuring_ed <- w2_reoccuring_ed %>%
  count(ID)

#  W3

w1_w3_ed <- w1_dx_ed[w1_dx_ed$ID %in% w3_dx_ed$ID, ] 
w2_w3_ed <- w2_dx_ed[w2_dx_ed$ID %in% w3_dx_ed$ID, ] 
w3_reoccuring_ed<- full_join(w1_w3_ed, full_join(w1_w3_ed, w2_w3_ed))
w3_reoccuring_ed <- w3_reoccuring_ed[!duplicated(w3_reoccuring_ed$ID), ]

w3_reoccuring_ed <- w3_reoccuring_ed %>%
  count(ID)

# W4 

w1_w4_ed <- w1_dx_ed[w1_dx_ed$ID %in% w4_dx_ed$ID, ]  
w2_w4_ed <- w2_dx_ed[w2_dx_ed$ID %in% w4_dx_ed$ID, ] 
w3_w4_ed <- w3_dx_ed[w3_dx_ed$ID %in% w4_dx_ed$ID, ]  
w4_reoccuring_ed <- full_join(w1_w4_ed, full_join(w2_w4_ed, w3_w4_ed))
w4_reoccuring_ed <- w4_reoccuring_ed[!duplicated(w4_reoccuring_ed$ID), ] 

w4_reoccuring_ed <- w4_reoccuring_ed %>%
  count(ID)

```

```{r output count}

w1_count <- data.frame(Total_Anx = sum(w1_dx_anxiety$n),
                       Total_Mood = sum(w1_dx_mood$n),
                       Total_ED = sum(w1_dx_ed$n),
                       Current_Anx = sum(w1_dx_anxiety_current$n),
                       Current_Mood = sum(w1_dx_mood_current$n),
                       Current_ED = sum(w1_dx_ed_current$n),
                       Past_Anx = sum(w1_dx_anxiety_past$n),
                       Past_Mood = sum(w1_dx_mood_past$n),
                       Past_ED = sum(w1_dx_ed_past$n),
                       Current_Comorbid = sum(w1_comorbid_current$n),
                       Past_Comorbid = sum(w1_comorbid_past$n),
                       PC_Anx = sum(w1_anx_pc$n),
                       PC_Mood = sum(w1_mood_pc$n),
                       PC_ED = sum(w1_ed_pc$n),
                       Anx_New = sum(w1_dx_anxiety$n),
                       Mood_New = sum(w1_dx_mood$n),
                       ED_New = sum(w1_dx_ed$n))

w1_count <- w1_count %>%
  pivot_longer(w1_count, cols=1:17, names_to = "Condition", values_to = "W1 Amount (n=174)")

#write.csv(w1_count, file = "w1_count_12.2021.csv")

w2_count <- data.frame(Total_Anx = sum(w2_dx_anxiety$n),
                       Total_Mood = sum(w2_dx_mood$n),
                       Total_ED = sum(w2_dx_ed$n),
                       Current_Anx = sum(w2_dx_anxiety_current$n),
                       Current_Mood = sum(w2_dx_mood_current$n),
                       Current_ED = sum(w2_dx_ed_current$n),
                       Past_Anx = sum(w2_dx_anxiety_past$n),
                       Past_Mood = sum(w2_dx_mood_past$n),
                       Past_ED = sum(w2_dx_ed_past$n),
                       Current_Comorbid = sum(w2_comorbid_current$n),
                       Past_Comorbid = sum(w2_comorbid_past$n),
                       PC_Anx = sum(w2_anx_pc$n),
                       PC_Mood = sum(w2_mood_pc$n),
                       PC_ED = sum(w2_ed_pc$n),
                       Anx_New = sum(w2_dx_anxiety$n)-sum(w2_reoccuring_anx$n),
                       Mood_New = sum(w2_dx_mood$n)-sum(w2_reoccuring_mood$n),
                       ED_New = sum(w2_dx_ed$n)-sum(w2_reoccuring_ed$n))

w2_count <- w2_count %>%
  pivot_longer(w2_count, cols=1:17, names_to = "Condition", values_to = "W2 Amount (n=163)")

#write.csv(w2_count, file = "w2_count_12.2021.csv")

w3_count <- data.frame(Total_Anx = sum(w3_dx_anxiety$n),
                       Total_Mood = sum(w3_dx_mood$n),
                       Total_ED = sum(w3_dx_ed$n),
                       Current_Anx = sum(w3_dx_anxiety_current$n),
                       Current_Mood = sum(w3_dx_mood_current$n),
                       Current_ED = sum(w3_dx_ed_current$n),
                       Past_Anx = sum(w3_dx_anxiety_past$n),
                       Past_Mood = sum(w3_dx_mood_past$n),
                       Past_ED = sum(w3_dx_ed_past$n),
                       Current_Comorbid = sum(w3_comorbid_current$n),
                       Past_Comorbid = sum(w3_comorbid_past$n),
                       PC_Anx = sum(w3_anx_pc$n),
                       PC_Mood = sum(w3_mood_pc$n),
                       PC_ED = sum(w3_ed_pc$n),
                       Anx_New = sum(w3_dx_anxiety$n)-sum(w3_reoccuring_anx$n),
                       Mood_New = sum(w3_dx_mood$n)-sum(w3_reoccuring_mood$n),
                       ED_New = sum(w3_dx_ed$n)-sum(w3_reoccuring_ed$n))

w3_count <- w3_count %>%
  pivot_longer(w3_count, cols=1:17, names_to = "Condition", values_to = "W3 Amount (n=150)")

#write.csv(w3_count, file = "w3_count_12.2021.csv")

w4_count <- data.frame(Total_Anx = sum(w4_dx_anxiety$n),
                       Total_Mood = sum(w4_dx_mood$n),
                       Total_ED = sum(w4_dx_ed$n),
                       Current_Anx = sum(w4_dx_anxiety_current$n),
                       Current_Mood = sum(w4_dx_mood_current$n),
                       Current_ED = sum(w4_dx_ed_current$n),
                       Past_Anx = sum(w4_dx_anxiety_past$n),
                       Past_Mood = sum(w4_dx_mood_past$n),
                       Past_ED = sum(w4_dx_ed_past$n),
                       Current_Comorbid = sum(w4_comorbid_current$n),
                       Past_Comorbid = sum(w4_comorbid_past$n),
                       PC_Anx = sum(w4_anx_pc$n),
                       PC_Mood = sum(w4_mood_pc$n),
                       PC_ED = sum(w4_ed_pc$n),
                       Anx_New = sum(w4_dx_anxiety$n)-sum(w4_reoccuring_anx$n),
                       Mood_New = sum(w4_dx_mood$n)-sum(w4_reoccuring_mood$n),
                       ED_New = sum(w4_dx_ed$n)-sum(w4_reoccuring_ed$n))

w4_count <- w4_count %>%
  pivot_longer(w4_count, cols=1:17, names_to = "Condition", values_to = "W4 Amount (n=39)")

#write.csv(w4_count, file = "w4_count_12.2021.csv")

dx_count <- full_join(w1_count, full_join(w2_count, w3_count))
dx_count <- full_join(dx_count, w4_count)

write.csv(dx_count, file = "dx_count.csv")

```

## Question 8: How many participants met for the same dx across waves?
```{r 8}
## How many participants met for the same dx across waves? 

## BY DX 

id_recurrences <- dx_full %>% group_by(dx, ID, dx_type) %>% tally()

across_4_waves_dx <-  id_recurrences[which(id_recurrences$n=="4"),]
across_3_waves_dx <-  id_recurrences[which(id_recurrences$n=="3"),]
across_2_waves_dx  <-  id_recurrences[which(id_recurrences$n=="2"),]
across_1_waves_dx  <-  id_recurrences[which(id_recurrences$n=="1"),]
across_4_waves_dx  <- across_4_waves_dx [!duplicated(across_4_waves_dx $ID), ]
across_3_waves_dx  <- across_3_waves_dx [!duplicated(across_3_waves_dx $ID), ] 
across_2_waves_dx  <- across_2_waves_dx [!duplicated(across_2_waves_dx $ID), ] 
across_1_waves_dx  <- across_1_waves_dx [!duplicated(across_1_waves_dx $ID), ] 

across_4_waves_dx  <- across_4_waves_dx  %>%
  count(ID)
across_3_waves_dx  <- across_3_waves_dx  %>%
  count(ID)
across_2_waves_dx  <- across_2_waves_dx  %>%
  count(ID)
across_1_waves_dx  <- across_1_waves_dx  %>%
  count(ID)

# BY CLASSIFICATION

id_recurrences <- dx_full %>% group_by(dx_type, ID) %>% tally()

across_4_waves <-  id_recurrences[which(id_recurrences$n=="4"),]
across_3_waves <-  id_recurrences[which(id_recurrences$n=="3"),]
across_2_waves <-  id_recurrences[which(id_recurrences$n=="2"),]
across_1_waves <-  id_recurrences[which(id_recurrences$n=="1"),]

across_4_waves <- across_4_waves[!duplicated(across_4_waves$ID), ] 
across_3_waves <- across_3_waves[!duplicated(across_3_waves$ID), ] 
across_2_waves <- across_2_waves[!duplicated(across_2_waves$ID), ] 
across_1_waves <- across_1_waves[!duplicated(across_1_waves$ID), ] 

across_4_waves_anx <- across_4_waves[which(across_4_waves$dx_type=="1"),]
across_3_waves_anx <- across_3_waves[which(across_3_waves$dx_type=="1"),]
across_2_waves_anx <-  across_2_waves[which(across_2_waves$dx_type=="1"),]
across_1_waves_anx <-  across_1_waves[which(across_1_waves$dx_type=="1"),]

across_4_waves_anx <- across_4_waves_anx  %>%
  count(ID)
across_3_waves_anx  <- across_3_waves_anx  %>%
  count(ID)
across_2_waves_anx  <- across_2_waves_anx  %>%
  count(ID)
across_1_waves_anx  <- across_1_waves_anx  %>%
  count(ID)

across_4_waves_mood <- across_4_waves[which(across_4_waves$dx_type=="2"),]
across_3_waves_mood <- across_3_waves[which(across_3_waves$dx_type=="2"),]
across_2_waves_mood <-  across_2_waves[which(across_2_waves$dx_type=="2"),]
across_1_waves_mood <-  across_1_waves[which(across_1_waves$dx_type=="2"),]

across_4_waves_mood <- across_4_waves_mood %>%
  count(ID)
across_3_waves_mood <- across_3_waves_mood %>%
  count(ID)
across_2_waves_mood <- across_2_waves_mood %>%
  count(ID)
across_1_waves_mood <- across_1_waves_mood %>%
  count(ID)

across_4_waves_ed <- across_4_waves[which(across_4_waves$dx_type=="3"),]
across_3_waves_ed <- across_3_waves[which(across_3_waves$dx_type=="3"),]
across_2_waves_ed <-  across_2_waves[which(across_2_waves$dx_type=="3"),]
across_1_waves_ed <-  across_1_waves[which(across_1_waves$dx_type=="3"),]

across_4_waves_ed <- across_4_waves_ed %>%
  count(ID)
across_3_waves_ed <- across_3_waves_ed %>%
  count(ID)
across_2_waves_ed <- across_2_waves_ed %>%
  count(ID)
across_1_waves_ed <- across_1_waves_ed %>%
  count(ID)

occurence_count <- data.frame(Dx_1 = sum(across_1_waves_dx$n),
                              Dx_2 = sum(across_2_waves_dx$n),
                              Dx_3 = sum(across_3_waves_dx$n),
                              Dx_4 = sum(across_4_waves_dx$n),
                              Anxiety_1 = sum(across_1_waves_anx$n),
                              Anxiety_2 = sum(across_2_waves_anx$n),
                              Anxiety_3 = sum(across_3_waves_anx$n),
                              Anxiety_4 = sum(across_4_waves_anx$n),
                              Mood_1 = sum(across_1_waves_mood$n),
                              Mood_2 = sum(across_2_waves_mood$n),
                              Mood_3 = sum(across_3_waves_mood$n),
                              Mood_4 = sum(across_4_waves_mood$n),
                              ED_1 = sum(across_1_waves_ed$n),
                              ED_2 = sum(across_2_waves_ed$n),
                              ED_3 = sum(across_3_waves_ed$n),
                              ED_4 = sum(across_4_waves_ed$n))

occurence_count <- occurence_count %>%
  pivot_longer(occurence_count, cols=1:16, names_to = "Condition", values_to = "Amount of Px") 

write.csv(occurence_count, file = "occurence_count.12.2021.csv")

```

```{r self-harm + dx}

## cleaning DSHI doc 

## changing any -3 to NA in DSHI doc 

dshi[dshi=="-3"] <- "NA"

## filtering out IDs who have NA for date of endorsement and self-harm (meaning they didn't meet for anything)

dshi <- dshi %>% filter(dshi$Date_Endorsement != "NA")

dshi <- dshi %>% filter(dshi$Self_Harm != "NA")

dshi <- dshi[which(dshi$Self_Harm == "1"),]

## creating a doc with just ID and the wave they met 

dshi <- dshi %>%
  select("ID", "Wave")

dshi <-dshi %>%
  mutate(no_underscores=paste0("TAG",
                               substring(ID,first=5,last=length(ID))))

colnames(dshi)[3] <- "ID"
dshi <-dshi[, -1]
dshi <-dshi[c(2, 1)]


## relabeling ACE endorsements to wave 3's 

dshi[dshi=="3.5 (Month 1)"] <- "3"
dshi[dshi=="3.5 (Month 2)"] <- "3"
dshi[dshi=="3.5 (Month 3)"] <- "3"
dshi[dshi=="3.5"] <- "3"

## creating separate wave docs for dshi endorsements 

dshi_w1 <-  dshi[which(dshi$Wave=="1"),]
dshi_w2 <-  dshi[which(dshi$Wave=="2"),]
dshi_w3 <-  dshi[which(dshi$Wave=="3"),]
dshi_w4 <-  dshi[which(dshi$Wave=="4"),]

## changing the class of Wave to integer 

dshi_w1$Wave <-  as.integer(dshi_w1$Wave)
dshi_w2$Wave <-  as.integer(dshi_w2$Wave)
dshi_w3$Wave <-  as.integer(dshi_w3$Wave)
dshi_w4$Wave <-  as.integer(dshi_w4$Wave)


dshi_w1 <- dshi_w1[!duplicated(dshi_w1$ID), ] 
dshi_w2 <- dshi_w2[!duplicated(dshi_w2$ID), ] 
dshi_w3 <- dshi_w3[!duplicated(dshi_w3$ID), ]
dshi_w4 <- dshi_w4[!duplicated(dshi_w4$ID), ]

dshi_w1 <- dshi_w1 %>%
  count(ID)
dshi_w2 <- dshi_w2 %>%
  count(ID)
dshi_w3 <- dshi_w3 %>%
  count(ID)
dshi_w4 <- dshi_w4 %>%
  count(ID)


```

## SH + Dx 
```{r SH}

## creating docs for folks who endorsed self-harm and met for a dx in the same wave 

w1_sh_dx <- w1_dx[w1_dx$ID %in% dshi_w1$ID,]
w2_sh_dx <- w2_dx[w2_dx$ID %in% dshi_w2$ID,]
w3_sh_dx <- w3_dx[w3_dx$ID %in% dshi_w3$ID,]
w4_sh_dx <- w4_dx[w4_dx$ID %in% dshi_w4$ID,]

w1_sh_dx <- w1_sh_dx[!duplicated(w1_sh_dx$ID), ] 
w2_sh_dx <- w2_sh_dx[!duplicated(w2_sh_dx$ID), ]
w3_sh_dx <- w3_sh_dx[!duplicated(w3_sh_dx$ID), ] 
w4_sh_dx <- w4_sh_dx[!duplicated(w4_sh_dx$ID), ] 

w1_sh_dx <- w1_sh_dx %>%
  count(ID)
w2_sh_dx <- w2_sh_dx %>%
  count(ID)
w3_sh_dx <- w3_sh_dx %>%
  count(ID)
w4_sh_dx <- w4_sh_dx %>%
  count(ID)


## creating docs for folks who endorsed self-harm but did not meet for dx 

w1_sh_no_dx <- subset(dshi_w1, !(ID %in% w1_sh_dx$ID))
w2_sh_no_dx <- subset(dshi_w2, !(ID %in% w2_sh_dx$ID))
w3_sh_no_dx <- subset(dshi_w3, !(ID %in% w3_sh_dx$ID))
w4_sh_no_dx <- subset(dshi_w4, !(ID %in% w4_sh_dx$ID))

w1_sh_no_dx <- w1_sh_no_dx[!duplicated(w1_sh_no_dx$ID), ] 
w2_sh_no_dx <- w2_sh_no_dx[!duplicated(w2_sh_no_dx$ID), ] 
w3_sh_no_dx <- w3_sh_no_dx[!duplicated(w3_sh_no_dx$ID), ]  
w4_sh_no_dx <- w4_sh_no_dx[!duplicated(w4_sh_no_dx$ID), ]

w1_sh_no_dx <- w1_sh_no_dx %>%
  count(ID)
w2_sh_no_dx <- w2_sh_no_dx %>%
  count(ID)
w3_sh_no_dx <- w3_sh_no_dx %>%
  count(ID)
w4_sh_no_dx <- w4_sh_no_dx %>%
  count(ID)

## anx + self-harm 

w1_sh_anx <- w1_dx_anxiety[w1_dx_anxiety$ID %in% dshi_w1$ID,]
w2_sh_anx <- w2_dx_anxiety[w2_dx_anxiety$ID %in% dshi_w2$ID,] 
w3_sh_anx <- w3_dx_anxiety[w3_dx_anxiety$ID %in% dshi_w3$ID,] 
w4_sh_anx <- w4_dx_anxiety[w4_dx_anxiety$ID %in% dshi_w4$ID,] 

w1_sh_anx <- w1_sh_anx %>%
  count(ID)
w2_sh_anx <- w2_sh_anx %>%
  count(ID)
w3_sh_anx <- w3_sh_anx %>%
  count(ID)
w4_sh_anx <- w4_sh_anx %>%
  count(ID)

## mood + self-harm 

w1_sh_mood <- w1_dx_mood[w1_dx_mood$ID %in% dshi_w1$ID,] 
w2_sh_mood <- w2_dx_mood[w2_dx_mood$ID %in% dshi_w2$ID,] 
w3_sh_mood <- w3_dx_mood[w3_dx_mood$ID %in% dshi_w3$ID,] 
w4_sh_mood <- w4_dx_mood[w4_dx_mood$ID %in% dshi_w4$ID,]

w1_sh_mood <- w1_sh_mood %>%
  count(ID)
w2_sh_mood <- w2_sh_mood %>%
  count(ID)
w3_sh_mood <- w3_sh_mood %>%
  count(ID)
w4_sh_mood <- w4_sh_mood %>%
  count(ID)

## mood + anx + sh 

w1_sh_anx_mood <- w1_sh_anx[w1_sh_anx$ID %in% w1_sh_mood$ID,] 
w2_sh_anx_mood <- w2_sh_anx[w2_sh_anx$ID %in% w2_sh_mood$ID,] 
w3_sh_anx_mood <- w3_sh_anx[w3_sh_anx$ID %in% w3_sh_mood$ID,]  
w4_sh_anx_mood <- w4_sh_anx[w4_sh_anx$ID %in% w4_sh_mood$ID,]

w1_sh_anx_mood <- w1_sh_anx_mood %>%
  count(ID)
w2_sh_anx_mood <- w2_sh_anx_mood %>%
  count(ID)
w3_sh_anx_mood <- w3_sh_anx_mood %>%
  count(ID)
w4_sh_anx_mood <- w4_sh_anx_mood %>%
  count(ID)

self_harm_count <- data.frame(W1_SH = sum(dshi_w1$n),
                              W2_SH = sum(dshi_w2$n),
                              W3_SH = sum(dshi_w3$n),
                              W4_SH = sum(dshi_w4$n),
                              W1_SH_Dx = sum(w1_sh_dx$n),
                              W2_SH_Dx = sum(w2_sh_dx$n),
                              W3_SH_Dx = sum(w3_sh_dx$n),
                              W4_SH_Dx = sum(w4_sh_dx$n),
                              W1_Sh_no_Dx = sum(w1_sh_no_dx$n),
                              W2_Sh_no_Dx = sum(w2_sh_no_dx$n),
                              W3_Sh_no_Dx = sum(w3_sh_no_dx$n),
                              W4_Sh_no_Dx = sum(w4_sh_no_dx$n),
                              W1_Anx_SH = sum(w1_sh_anx$n),
                              W2_Anx_SH = sum(w2_sh_anx$n),
                              W3_Anx_SH = sum(w3_sh_anx$n),
                              W4_Anx_SH = sum(w4_sh_anx$n),
                              W1_Mood_SH = sum(w1_sh_mood$n),
                              W2_Mood_SH = sum(w2_sh_mood$n),
                              W3_Mood_SH = sum(w3_sh_mood$n),
                              W4_Mood_SH = sum(w4_sh_mood$n),
                              W1_Anx_Mood_SH = sum(w1_sh_anx_mood$n),
                              W2_Anx_Mood_SH = sum(w2_sh_anx_mood$n),
                              W3_Anx_Mood_SH = sum(w3_sh_anx_mood$n),
                              W4_Anx_Mood_SH = sum(w4_sh_anx_mood$n))

self_harm_count <- self_harm_count %>%
  pivot_longer(self_harm_count, cols=1:24, names_to = "Condition", values_to = "Amount")

write.csv(self_harm_count, file = "self_harm_count.csv")

```

```{r visualizing for all dx}

## visualizing by diagnoses participant

## creating wave variable 


dx_full$Wave_1_C <- paste(dx_full$W1_current)
dx_full$Wave_1_P <- paste(dx_full$W1_past)
dx_full$Wave_2_C <- paste(dx_full$W2_current)
dx_full$Wave_2_P <- paste(dx_full$W2_past)
dx_full$Wave_3_C <- paste(dx_full$W3_current)
dx_full$Wave_3_P <- paste(dx_full$W3_past)

dx_full$Wave_1_C[dx_full$Wave_1_C=="1"] = "1"
dx_full$Wave_1_P[dx_full$Wave_1_P=="1"] = "1"
dx_full$Wave_2_C[dx_full$Wave_2_C=="1"] = "2"
dx_full$Wave_2_P[dx_full$Wave_2_P=="1"] = "2"
dx_full$Wave_3_C[dx_full$Wave_3_C=="1"] = "3"
dx_full$Wave_3_P[dx_full$Wave_3_P=="1"] = "3"

dx_full <- dx_full %>%
  unite("Wave", Wave_1_C:Wave_1_P:Wave_2_C:Wave_2_P:Wave_3_C:Wave_3_P)

dx_full <- dx_full %>%
  mutate(Wave=ifelse(Wave=="1_NA_NA_NA_NA_NA", "1",
                     ifelse(Wave=="NA_1_NA_NA_NA_NA", "1",
                            ifelse(Wave=="NA_NA_2_NA_NA_NA", "2",
                                   ifelse(Wave=="NA_NA_NA_2_NA_NA", "2",
                                          ifelse(Wave=="NA_NA_NA_NA_3_NA", "3",
                                                 ifelse(Wave=="NA_NA_NA_NA_NA_3", "3",
                                                        Wave)))))))

dx_full$Wave <- as.factor(dx_full$Wave)
dx_full$dx_type <- as.integer(dx_full$dx_type)

dx_full$onset_age_months_decimal <- dx_full$onset_age_months/12

dx_full$onset_age <- dx_full$onset_age_years + dx_full$onset_age_months_decimal

dx_full <-  dx_full[-c(1,2),]

dx_by_px<- ggplot(dx_full,
                           aes(x=dx_type,
                               y=onset_age,
                               group=ID,
                               col=Wave,
                               shape=Wave)) + 
  geom_point(alpha=1) + 
  geom_line(alpha=.4)+
  theme(axis.text.y = element_blank()) +
  scale_color_manual(name= "Wave",
                     labels = c("W1", "W2", "W3"),
                     values = c("#5445b1", "#749dae", "#f3c483"))  +
  scale_shape_manual(name= "Wave",
              labels= c("W1", "W2", "W3"),
              values = c(0, 1, 2))+
  ylab("Age of Onset (years)") +
	ylim(5, 16) +
  xlab("Diagnosis Type")+
  scale_x_continuous(breaks = 1:3,
  labels = paste0(c("Anxiety", "Mood", "Eating")))+
  theme_minimal()


```

```{r visualizing just depressive disorders}

## creating document with just depressive disorders 

dx_depressive_MDD <-  dx_full[which(dx_full$dx=="MDD"),]
dx_depressive_DYS <-  dx_full[which(dx_full$dx=="DYS"),]
dx_depressive_DNOS <-  dx_full[which(dx_full$dx=="DNOS"),]

dx_depressive <- full_join(dx_depressive_MDD, dx_depressive_DNOS)
dx_depressive <- full_join(dx_depressive, dx_depressive_DYS)

dx_depressive$dx[dx_depressive$dx=="MDD"] = "1"
dx_depressive$dx[dx_depressive$dx=="DYS"] = "2"
dx_depressive$dx[dx_depressive$dx=="DNOS"] = "3"


dx_depressive$Wave_1_C <- paste(dx_depressive$W1_current)
dx_depressive$Wave_1_P <- paste(dx_depressive$W1_past)
dx_depressive$Wave_2_C <- paste(dx_depressive$W2_current)
dx_depressive$Wave_2_P <- paste(dx_depressive$W2_past)
dx_depressive$Wave_3_C <- paste(dx_depressive$W3_current)
dx_depressive$Wave_3_P <- paste(dx_depressive$W3_past)

dx_depressive$Wave_1_C[dx_depressive$Wave_1_C=="1"] = "1"
dx_depressive$Wave_1_P[dx_depressive$Wave_1_P=="1"] = "1"
dx_depressive$Wave_2_C[dx_depressive$Wave_2_C=="1"] = "2"
dx_depressive$Wave_2_P[dx_depressive$Wave_2_P=="1"] = "2"
dx_depressive$Wave_3_C[dx_depressive$Wave_3_C=="1"] = "3"
dx_depressive$Wave_3_P[dx_depressive$Wave_3_P=="1"] = "3"

dx_depressive <- dx_depressive %>%
  unite("Wave", Wave_1_C:Wave_1_P:Wave_2_C:Wave_2_P:Wave_3_C:Wave_3_P)

dx_depressive <- dx_depressive %>%
  mutate(Wave=ifelse(Wave=="1_NA_NA_NA_NA_NA", "1",
                     ifelse(Wave=="NA_1_NA_NA_NA_NA", "1",
                            ifelse(Wave=="NA_NA_2_NA_NA_NA", "2",
                                   ifelse(Wave=="NA_NA_NA_2_NA_NA", "2",
                                          ifelse(Wave=="NA_NA_NA_NA_3_NA", "3",
                                                 ifelse(Wave=="NA_NA_NA_NA_NA_3", "3",
                                                        Wave)))))))

dx_depressive$Wave <- as.factor(dx_depressive$Wave)
dx_depressive$dx <- as.integer(dx_depressive$dx)

dx_depressive$onset_age_months_decimal <- dx_depressive$onset_age_months/12

dx_depressive$onset_age <- dx_depressive$onset_age_years + dx_depressive$onset_age_months_decimal

dx_depressive <-  dx_depressive[(-1),]

dep_dx_by_px<- ggplot(dx_depressive,
                           aes(x=dx,
                               y=onset_age,
                               group=ID,
                               col=Wave,
                               shape=Wave)) + 
  geom_point(alpha=1) + 
  geom_line(alpha=.4)+
  theme(axis.text.y = element_blank()) +
  scale_color_manual(name= "Wave",
                     labels = c("W1", "W2", "W3"),
                     values = c("#5445b1", "#749dae", "#f3c483"))  +
  scale_shape_manual(name= "Wave",
              labels= c("W1", "W2", "W3"),
              values = c(0, 1, 2))+
  ylab("Age of Onset (years)") +
	ylim(5, 16) +
  xlab("Diagnosis Type")+
  scale_x_continuous(breaks = 1:3,
  labels = paste0(c("MDD", "DYS", "DNOS")))+
  theme_minimal()


```

